Starting TestNSMDDRegistryNSE on kind-1
Command line go test . -test.timeout 10m0s -count 1 --run "^(TestNSMDDRegistryNSE)$\\z" --tags "basic" --test.v
env==[KUBECONFIG=/Users/nispatil/go/src/github.com/cisco-app-networking/nsm_publish/networkservicemesh/.tests/cloud_test/single-cluster/shell/kind-1/config ARTIFACTS_DIR=/Users/nispatil/go/src/github.com/cisco-app-networking/nsm_publish/networkservicemesh/.tests/cloud_test/single-cluster/kind-1/TestNSMDDRegistryNSE] 

=== RUN   TestNSMDDRegistryNSE
time="2021-06-08T20:39:02-07:00" level=info msg="Using Kubeconfig: /Users/nispatil/go/src/github.com/cisco-app-networking/nsm_publish/networkservicemesh/.tests/cloud_test/single-cluster/shell/kind-1/config"
time="2021-06-08T20:39:02-07:00" level=info msg="FORWARDING_PLANE not set, using default forwarder - vpp"
time="2021-06-08T20:39:02-07:00" level=info msg="Creating artifact manager with config: &{4 false /Users/nispatil/go/src/github.com/cisco-app-networking/nsm_publish/networkservicemesh/.tests/cloud_test/single-cluster/kind-1/TestNSMDDRegistryNSE}"
time="2021-06-08T20:39:02-07:00" level=error msg="Error during create of test namespace failed to create a namespace: namespaces \"nsm-system\" already exists"
time="2021-06-08T20:39:02-07:00" level=info msg="Checking availability of API server on 127.0.0.1"
time="2021-06-08T20:39:06-07:00" level=info msg="PING 127.0.0.1 (127.0.0.1): 56 data bytes\n64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.063 ms\n64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.048 ms\n64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.085 ms\n64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.035 ms\n64 bytes from 127.0.0.1: icmp_seq=4 ttl=64 time=0.042 ms\n\n--- 127.0.0.1 ping statistics ---\n5 packets transmitted, 5 packets received, 0.0%!p(MISSING)acket loss\nround-trip min/avg/max/stddev = 0.035/0.055/0.085/0.018 ms\n"
time="2021-06-08T20:39:06-07:00" level=info msg="USE_IPV6 not set, using default false"
time="2021-06-08T20:39:06-07:00" level=error msg="serviceaccounts \"nsc-acc\" not found"
time="2021-06-08T20:39:06-07:00" level=error msg="serviceaccounts \"nse-acc\" not found"
time="2021-06-08T20:39:06-07:00" level=error msg="serviceaccounts \"nsmgr-acc\" not found"
time="2021-06-08T20:39:06-07:00" level=error msg="serviceaccounts \"nsmrs-acc\" not found"
time="2021-06-08T20:39:07-07:00" level=error msg="serviceaccounts \"forward-plane-acc\" not found"
time="2021-06-08T20:39:07-07:00" level=error msg="serviceaccounts \"crossconnect-monitor-acc\" not found"
time="2021-06-08T20:39:07-07:00" level=error msg="serviceaccounts \"proxy-nsmgr-acc\" not found"
time="2021-06-08T20:39:07-07:00" level=info msg="Cleanup done: 846.649134ms"
time="2021-06-08T20:39:07-07:00" level=info msg="&ServiceAccount{ObjectMeta:{default  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/default 1ae7827d-1719-4ffc-82b2-303fb8b314af 23950 0 2021-06-08 20:38:56 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:default-token-4q5jw,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
I0608 20:39:08.631415   39713 request.go:621] Throttling request took 1.157538224s, request: POST:https://127.0.0.1:55081/api/v1/namespaces/nsm-system/serviceaccounts
time="2021-06-08T20:39:09-07:00" level=info msg="&ServiceAccount{ObjectMeta:{nsmgr-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/nsmgr-acc 572b71ea-bad6-4ae1-a046-e564726e09f5 24018 0 2021-06-08 20:39:07 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:nsmgr-acc-token-5wphl,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:09-07:00" level=info msg="&ServiceAccount{ObjectMeta:{nse-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/nse-acc 6bbed993-bbd0-43ef-83a0-62921e121896 24021 0 2021-06-08 20:39:08 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:nse-acc-token-rf97c,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:09-07:00" level=info msg="&ServiceAccount{ObjectMeta:{crossconnect-monitor-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/crossconnect-monitor-acc 3decdd0b-a209-4d44-8c74-82f8fe48ca84 24024 0 2021-06-08 20:39:08 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:crossconnect-monitor-acc-token-4cn5t,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:09-07:00" level=info msg="&ServiceAccount{ObjectMeta:{nsmrs-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/nsmrs-acc af9535a0-5eef-44b5-88c5-b9b2a3234af2 24028 0 2021-06-08 20:39:08 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:nsmrs-acc-token-9zd4c,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:10-07:00" level=info msg="&ServiceAccount{ObjectMeta:{forward-plane-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/forward-plane-acc 9576797c-e93a-4aaf-8de0-7a69abcd7a31 24031 0 2021-06-08 20:39:08 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:forward-plane-acc-token-gw7z5,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:10-07:00" level=info msg="&ServiceAccount{ObjectMeta:{nsc-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/nsc-acc 4e0bf2b8-de19-471b-bc1a-608553a8d89d 24034 0 2021-06-08 20:39:08 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:nsc-acc-token-jmmrc,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:10-07:00" level=info msg="&ServiceAccount{ObjectMeta:{proxy-nsmgr-acc  nsm-system /api/v1/namespaces/nsm-system/serviceaccounts/proxy-nsmgr-acc 18f1130e-b6f2-43f5-a35f-fa59c23730ad 24039 0 2021-06-08 20:39:09 -0700 PDT <nil> <nil> map[] map[] [] []  []},Secrets:[]ObjectReference{ObjectReference{Kind:,Namespace:,Name:proxy-nsmgr-acc-token-sjbwt,UID:,APIVersion:,ResourceVersion:,FieldPath:,},},ImagePullSecrets:[]LocalObjectReference{},AutomountServiceAccountToken:nil,}"
time="2021-06-08T20:39:10-07:00" level=info msg="Creating ConfigMap 'nsm-config' in namespace'nsm-system'..."
time="2021-06-08T20:39:10-07:00" level=info msg="Using image: containers.cisco.com/appn/prefix-service:vl3_latest"
time="2021-06-08T20:39:10-07:00" level=info msg="Using image: containers.cisco.com/appn/test-common:vl3_latest"
time="2021-06-08T20:39:10-07:00" level=info msg="role is created: &ClusterRoleBinding{ObjectMeta:{nsm-role-binding      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[] [] []  []},Subjects:[]Subject{Subject{Kind:ServiceAccount,APIGroup:,Name:nsmgr-acc,Namespace:nsm-system,},Subject{Kind:ServiceAccount,APIGroup:,Name:proxy-nsmgr-acc,Namespace:nsm-system,},Subject{Kind:ServiceAccount,APIGroup:,Name:crossconnect-monitor-acc,Namespace:nsm-system,},},RoleRef:RoleRef{APIGroup:rbac.authorization.k8s.io,Kind:ClusterRole,Name:nsm-role,},}"
time="2021-06-08T20:39:10-07:00" level=info msg="role is created: &ClusterRole{ObjectMeta:{nsm-role  nsm-system    0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[rbac.authorization.k8s.io/aggregate-to-admin:true rbac.authorization.k8s.io/aggregate-to-edit:true] map[] [] []  []},Rules:[]PolicyRule{PolicyRule{Verbs:[*],APIGroups:[networkservicemesh.io],Resources:[networkservices networkserviceendpoints networkservicemanagers],ResourceNames:[],NonResourceURLs:[],},PolicyRule{Verbs:[*],APIGroups:[apiextensions.k8s.io],Resources:[customresourcedefinitions],ResourceNames:[],NonResourceURLs:[],},PolicyRule{Verbs:[get update],APIGroups:[],Resources:[configmaps],ResourceNames:[],NonResourceURLs:[],},PolicyRule{Verbs:[get list watch],APIGroups:[],Resources:[nodes services namespaces],ResourceNames:[],NonResourceURLs:[],},},AggregationRule:nil,}"
time="2021-06-08T20:39:10-07:00" level=info msg="role is created: &ClusterRole{ObjectMeta:{aggregate-network-services-view  nsm-system    0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[rbac.authorization.k8s.io/aggregate-to-view:true] map[] [] []  []},Rules:[]PolicyRule{PolicyRule{Verbs:[get list watch],APIGroups:[networkservicemesh.io],Resources:[networkservices],ResourceNames:[],NonResourceURLs:[],},},AggregationRule:nil,}"
time="2021-06-08T20:39:13-07:00" level=info msg="Trying to establish connection with the spire provider at address:tcp://127.0.0.1:52914"
time="2021-06-08T20:39:13-07:00" level=info msg="Created the todo context:tcp://127.0.0.1:52914"
time="2021-06-08T20:39:13-07:00" level=info msg="Got x509:&{0xc0005153b0 <nil> {{0 0} 0 0 0 0} 0xc0002048c0 0xc000909e00 {{0 0} 0 0 0 0} false} <nil>"
time="2021-06-08T20:39:13-07:00" level=info msg="Started goroutine"
time="2021-06-08T20:39:13-07:00" level=info msg="Returning provider"
time="2021-06-08T20:39:13-07:00" level=info msg="Issued identity:spiffe://test.com/nsmgr"
time="2021-06-08T20:39:13-07:00" level=info msg="Using image: containers.cisco.com/appn/nsmdp:vl3_latest"
time="2021-06-08T20:39:13-07:00" level=info msg="Using image: containers.cisco.com/appn/nsmd:vl3_latest"
time="2021-06-08T20:39:13-07:00" level=info msg="Using image: containers.cisco.com/appn/nsmd-k8s:vl3_latest"
time="2021-06-08T20:39:25-07:00" level=info msg="time=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting nsmd-k8s...\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Version: v1.0.1-rc.2-1-g9262b77b\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"All env variables:\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_VERBOSITY_LEVEL=99\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOSTNAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_SEVERITY_LEVEL=info\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"SHLVL=1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOME=/root\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSM_NAMESPACE=nsm-system\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NODE_NAME=master\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_NAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PROTO=tcp\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"ENTRY=nsmd-k8s\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT_HTTPS=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSMD_LOCAL_REGISTRY_DELETE=true\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_HOST=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PWD=/\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_UID=a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Creating logger from config: &{nsmd-k8s@nsmgr-1 false false [] 0xc00051c060 0xc00051e000 <nil> <nil> <nil>}\"\n2021/06/09 03:39:22 debug logging disabled\n2021/06/09 03:39:22 Initializing logging reporter\n2021/06/09 03:39:22 debug logging disabled\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==--> Start-NSMD-k8s() span:5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- address=\\\"0.0.0.0:5000\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- nsmName=\\\"master\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- NODE_NAME=master span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting NSMD Kubernetes on 0.0.0.0:5000 with NsmName master\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==----> K8SServer.New() span:5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==------> NewServer() span:5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"readDialConfig insecure: false\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Trying to establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Created the todo context:unix:///run/spire/sockets/agent.sock\"\nINFO: 2021/06/09 03:39:22 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:22 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba098 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:22 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:22 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {READY <nil>}\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Got x509:&{0xc0001927e0 <nil> {{0 0} 0 0 0 0} 0xc00040b7c0 0xc0005e3780 {{0 0} 0 0 0 0} false} <nil>\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Started goroutine\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Returning provider\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"GRPC.NewServer with open tracing enabled\" operation=NewServer span=\"5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"==--------> GetCertificate() span:5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\"\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba150 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Issued identity:spiffe://test.com/nsmgr\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc00000e080 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"SPIRE -- GetX509SVID:&{spiffe://test.com/nsmgr [0xc000168000] 0xc0000463f0}\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Default trust domain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"defaultTrustDomain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"AUTHORIZING ALL CLIENTS\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Server will be started in secure mode using tlsConfig:&{<nil> <nil> [] map[] 0x99b800 <nil> <nil> 0x99b900 <nil> <nil> []  RequireAnyClientCert <nil> false [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network services with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"RegistryCache started\" operation=K8SServer.New span=\"5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"nsmd-k8s initialized and waiting for connection\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\nWARNING: 2021/06/09 03:39:24 [core] grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:49076\": EOF\nINFO: 2021/06/09 03:39:24 [transport] transport: loopyWriter.run returning. connection error: desc = \"transport is closing\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/RegisterNSM()=\\\"\\\" span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"==--> RegisterNSM() span:5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm-cr={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"creationTimestamp\\\":null,\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"CreateOrUpdateNSM attempt 0: \"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Creating NSM: &{{ } {master      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc0005235d8 0xc0005235d9}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24.3605756 +0000 UTC m=+1.508090801} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Start apply filter by namespace nsm-system for &{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkServiceManager\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Add(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- registered-nsm={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"namespace\\\":\\\"nsm-system\\\",\\\"selfLink\\\":\\\"/apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master\\\",\\\"uid\\\":\\\"d0d56e78-33f1-4755-976a-a211506b7f73\\\",\\\"resourceVersion\\\":\\\"24126\\\",\\\"generation\\\":1,\\\"creationTimestamp\\\":\\\"2021-06-09T03:39:24Z\\\",\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/GetEndpoints()=\\\"\\\" span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Received GetEndpoints\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"GetEndpoints return: []\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\n"
time="2021-06-08T20:39:25-07:00" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-08T20:39:25-07:00" level=info msg="==--> initRegistryClient() span:{}"
time="2021-06-08T20:39:25-07:00" level=info msg="Waiting for liveness probe: tcp:localhost:52917"
time="2021-06-08T20:39:25-07:00" level=info msg="Liveness probe was successful: tcp:localhost:52917"
time="2021-06-08T20:39:25-07:00" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="{}"
time="2021-06-08T20:39:25-07:00" level=info msg="Trying to establish connection to target: localhost:52917"
time="2021-06-08T20:39:25-07:00" level=info msg="func insecure: false, env insecure: false"
time="2021-06-08T20:39:25-07:00" level=info msg="Connecting to the workload api at:tcp://127.0.0.1:52914"
time="2021-06-08T20:39:25-07:00" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{test.com}:0xc00038bf40]}"
time="2021-06-08T20:39:25-07:00" level=info msg="defaultTrustDomain:test.com"
time="2021-06-08T20:39:25-07:00" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-08T20:39:25-07:00" level=info msg="Fetch tlsConfig for Trust Domain: test.com"
time="2021-06-08T20:39:25-07:00" level=info msg="Found 1 tlsconfigs."
time="2021-06-08T20:39:25-07:00" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0x1a28f80 <nil> 0x1a29000 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-08T20:39:25-07:00" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0x1a28f80 <nil> 0x1a29000 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-08T20:39:25-07:00" level=info msg="Successfully connected to localhost:52917" operation=initRegistryClient span="{}"
time="2021-06-08T20:39:25-07:00" level=info msg="rpc error: code = Unknown desc = no NetworkService with name: my_service"
time="2021-06-08T20:39:25-07:00" level=info msg="Requesting NseRegistryClient..."
time="2021-06-08T20:39:25-07:00" level=info msg="Register time: time: 59.88124ms network_service:<name:\"my-network-service\" payload:\"tcp\" > network_service_manager:<name:\"master\" url:\"10.244.2.90:5001\" state:\"RUNNING\" > network_service_endpoint:<name:\"my-network-service7l672\" payload:\"tcp\" network_service_name:\"my-network-service\" network_service_manager_name:\"master\" labels:<key:\"networkservicename\" value:\"my-network-service\" > state:\"RUNNING\" > "
time="2021-06-08T20:39:25-07:00" level=info msg="Find time: time: 6.792015ms 1"
time="2021-06-08T20:39:25-07:00" level=info msg="time=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting nsmd-k8s...\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Version: v1.0.1-rc.2-1-g9262b77b\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"All env variables:\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_VERBOSITY_LEVEL=99\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOSTNAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_SEVERITY_LEVEL=info\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"SHLVL=1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOME=/root\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSM_NAMESPACE=nsm-system\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NODE_NAME=master\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_NAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PROTO=tcp\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"ENTRY=nsmd-k8s\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT_HTTPS=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSMD_LOCAL_REGISTRY_DELETE=true\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_HOST=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PWD=/\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_UID=a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Creating logger from config: &{nsmd-k8s@nsmgr-1 false false [] 0xc00051c060 0xc00051e000 <nil> <nil> <nil>}\"\n2021/06/09 03:39:22 debug logging disabled\n2021/06/09 03:39:22 Initializing logging reporter\n2021/06/09 03:39:22 debug logging disabled\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==--> Start-NSMD-k8s() span:5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- address=\\\"0.0.0.0:5000\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- nsmName=\\\"master\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- NODE_NAME=master span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting NSMD Kubernetes on 0.0.0.0:5000 with NsmName master\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==----> K8SServer.New() span:5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==------> NewServer() span:5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"readDialConfig insecure: false\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Trying to establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Created the todo context:unix:///run/spire/sockets/agent.sock\"\nINFO: 2021/06/09 03:39:22 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:22 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba098 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:22 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:22 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {READY <nil>}\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Got x509:&{0xc0001927e0 <nil> {{0 0} 0 0 0 0} 0xc00040b7c0 0xc0005e3780 {{0 0} 0 0 0 0} false} <nil>\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Started goroutine\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Returning provider\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"GRPC.NewServer with open tracing enabled\" operation=NewServer span=\"5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"==--------> GetCertificate() span:5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\"\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba150 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Issued identity:spiffe://test.com/nsmgr\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc00000e080 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"SPIRE -- GetX509SVID:&{spiffe://test.com/nsmgr [0xc000168000] 0xc0000463f0}\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Default trust domain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"defaultTrustDomain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"AUTHORIZING ALL CLIENTS\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Server will be started in secure mode using tlsConfig:&{<nil> <nil> [] map[] 0x99b800 <nil> <nil> 0x99b900 <nil> <nil> []  RequireAnyClientCert <nil> false [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network services with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"RegistryCache started\" operation=K8SServer.New span=\"5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"nsmd-k8s initialized and waiting for connection\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\nWARNING: 2021/06/09 03:39:24 [core] grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:49076\": EOF\nINFO: 2021/06/09 03:39:24 [transport] transport: loopyWriter.run returning. connection error: desc = \"transport is closing\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/RegisterNSM()=\\\"\\\" span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"==--> RegisterNSM() span:5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm-cr={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"creationTimestamp\\\":null,\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"CreateOrUpdateNSM attempt 0: \"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Creating NSM: &{{ } {master      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc0005235d8 0xc0005235d9}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24.3605756 +0000 UTC m=+1.508090801} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Start apply filter by namespace nsm-system for &{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkServiceManager\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Add(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- registered-nsm={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"namespace\\\":\\\"nsm-system\\\",\\\"selfLink\\\":\\\"/apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master\\\",\\\"uid\\\":\\\"d0d56e78-33f1-4755-976a-a211506b7f73\\\",\\\"resourceVersion\\\":\\\"24126\\\",\\\"generation\\\":1,\\\"creationTimestamp\\\":\\\"2021-06-09T03:39:24Z\\\",\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/GetEndpoints()=\\\"\\\" span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Received GetEndpoints\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"GetEndpoints return: []\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\nWARNING: 2021/06/09 03:39:25 [core] grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:49124\": EOF\nINFO: 2021/06/09 03:39:25 [transport] transport: loopyWriter.run returning. connection error: desc = \"transport is closing\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceDiscovery/FindNetworkService()=\\\"\\\" span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my_service\\\"} span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> discovery.FindNetworkService() span:04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my_service\\\"} span=04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\"\n2021/06/09 03:39:25 Reporting span 04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response=null span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceRegistry/RegisterNSE()=\\\"\\\" span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_endpoint\\\":{\\\"network_service_name\\\":\\\"my-network-service\\\"}} span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> nsmgr.RegisterNSE() span:5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Received RegisterNSE(network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_endpoint:<network_service_name:\\\"my-network-service\\\" > )\" operation=nsmgr.RegisterNSE span=\"5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkService\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Adding NSE to cache: {{ } {my-network-service7l672 my-network-service nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/my-network-service7l672 db0f5eb9-fee5-4d62-a2d8-8e4f2b56c3b8 24133 1 2021-06-09 03:39:25 +0000 UTC <nil> <nil> map[networkservicename:my-network-service] map[] [] []  []} {my-network-service tcp master} {RUNNING}}\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkServiceEndpoint\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Returned from RegisterNSE: time: 13.8562ms request: network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_manager:<name:\\\"master\\\" url:\\\"10.244.2.90:5001\\\" state:\\\"RUNNING\\\" > network_service_endpoint:<name:\\\"my-network-service7l672\\\" payload:\\\"tcp\\\" network_service_name:\\\"my-network-service\\\" network_service_manager_name:\\\"master\\\" labels:<key:\\\"networkservicename\\\" value:\\\"my-network-service\\\" > state:\\\"RUNNING\\\" > \" operation=nsmgr.RegisterNSE span=\"5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\n2021/06/09 03:39:25 Reporting span 5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> ProxyNsmgr.forwardRegisterNSE() span:49e4d317789dd46c:49e4d317789dd46c:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_manager\\\":{\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"},\\\"network_service_endpoint\\\":{\\\"name\\\":\\\"my-network-service7l672\\\",\\\"payload\\\":\\\"tcp\\\",\\\"network_service_name\\\":\\\"my-network-service\\\",\\\"network_service_manager_name\\\":\\\"master\\\",\\\"labels\\\":{\\\"networkservicename\\\":\\\"my-network-service\\\"},\\\"state\\\":\\\"RUNNING\\\"}} span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 5b801670d070fff0:5b801670d070fff0:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Forwarding Register NSE request (network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_manager:<name:\\\"master\\\" url:\\\"10.244.2.90:5001\\\" state:\\\"RUNNING\\\" > network_service_endpoint:<name:\\\"my-network-service7l672\\\" payload:\\\"tcp\\\" network_service_name:\\\"my-network-service\\\" network_service_manager_name:\\\"master\\\" labels:<key:\\\"networkservicename\\\" value:\\\"my-network-service\\\" > state:\\\"RUNNING\\\" > )\" operation=ProxyNsmgr.forwardRegisterNSE span=\"49e4d317789dd46c:49e4d317789dd46c:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Requesting NseRegistryClient...\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==----> initRegistryClient() span:49e4d317789dd46c:3d79b609f30a4a9a:49e4d317789dd46c:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Waiting for liveness probe: tcp:pnsmgr-svc:5005\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceDiscovery/FindNetworkService()=\\\"\\\" span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> discovery.FindNetworkService() span:479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"NSE found 1, retrieve time: 23.3µs\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"FindNetworkService done: time 456.1µs [my-network-service7l672]\"\n2021/06/09 03:39:25 Reporting span 479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={\\\"payload\\\":\\\"tcp\\\",\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_managers\\\":{\\\"master\\\":{\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"}},\\\"network_service_endpoints\\\":[{\\\"name\\\":\\\"my-network-service7l672\\\",\\\"payload\\\":\\\"tcp\\\",\\\"network_service_name\\\":\\\"my-network-service\\\",\\\"network_service_manager_name\\\":\\\"master\\\",\\\"labels\\\":{\\\"networkservicename\\\":\\\"my-network-service\\\"},\\\"state\\\":\\\"RUNNING\\\"}]} span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 479b98b284a695eb:479b98b284a695eb:0000000000000000:1\n"
time="2021-06-08T20:39:25-07:00" level=info msg="Find time: time: 45.86778ms 0"
time="2021-06-08T20:39:26-07:00" level=info msg="time=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting nsmd-k8s...\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Version: v1.0.1-rc.2-1-g9262b77b\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"All env variables:\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_VERBOSITY_LEVEL=99\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOSTNAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"GRPC_GO_LOG_SEVERITY_LEVEL=info\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"SHLVL=1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"HOME=/root\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSM_NAMESPACE=nsm-system\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NODE_NAME=master\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_NAME=nsmgr-1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PORT=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP_PROTO=tcp\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"ENTRY=nsmd-k8s\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_PORT_HTTPS=443\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"NSMD_LOCAL_REGISTRY_DELETE=true\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"KUBERNETES_SERVICE_HOST=10.96.0.1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"PWD=/\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"POD_UID=a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Creating logger from config: &{nsmd-k8s@nsmgr-1 false false [] 0xc00051c060 0xc00051e000 <nil> <nil> <nil>}\"\n2021/06/09 03:39:22 debug logging disabled\n2021/06/09 03:39:22 Initializing logging reporter\n2021/06/09 03:39:22 debug logging disabled\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==--> Start-NSMD-k8s() span:5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- address=\\\"0.0.0.0:5000\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- nsmName=\\\"master\\\" span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\">><<-- NODE_NAME=master span=5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Starting NSMD Kubernetes on 0.0.0.0:5000 with NsmName master\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==----> K8SServer.New() span:5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"==------> NewServer() span:5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"readDialConfig insecure: false\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Trying to establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock\"\ntime=\"2021-06-09T03:39:22Z\" level=info msg=\"Created the todo context:unix:///run/spire/sockets/agent.sock\"\nINFO: 2021/06/09 03:39:22 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:22 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba098 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:22 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:22 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:22 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:22 [core] pickfirstBalancer: UpdateSubConnState: 0xc0003c1a60, {READY <nil>}\nINFO: 2021/06/09 03:39:22 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Got x509:&{0xc0001927e0 <nil> {{0 0} 0 0 0 0} 0xc00040b7c0 0xc0005e3780 {{0 0} 0 0 0 0} false} <nil>\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Started goroutine\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Returning provider\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"GRPC.NewServer with open tracing enabled\" operation=NewServer span=\"5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"==--------> GetCertificate() span:5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\"\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc0005ba150 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Issued identity:spiffe://test.com/nsmgr\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc0005e4ac0, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] parsed scheme: \"unix\"\nINFO: 2021/06/09 03:39:23 [core] ccResolverWrapper: sending update to cc: {[{/run/spire/sockets/agent.sock  0xc00000e080 0 <nil>}] <nil> <nil>}\nINFO: 2021/06/09 03:39:23 [core] ClientConn switching balancer to \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Channel switches to new LB policy \"pick_first\"\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] blockingPicker: the picked transport is not ready, loop back to repick\nINFO: 2021/06/09 03:39:23 [core] Subchannel picks a new address \"/run/spire/sockets/agent.sock\" to connect\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {CONNECTING <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to CONNECTING\nINFO: 2021/06/09 03:39:23 [core] Subchannel Connectivity change to READY\nINFO: 2021/06/09 03:39:23 [core] pickfirstBalancer: UpdateSubConnState: 0xc00003aa90, {READY <nil>}\nINFO: 2021/06/09 03:39:23 [core] Channel Connectivity change to READY\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"SPIRE -- GetX509SVID:&{spiffe://test.com/nsmgr [0xc000168000] 0xc0000463f0}\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Default trust domain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"defaultTrustDomain:test.com\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"AUTHORIZING ALL CLIENTS\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Server will be started in secure mode using tlsConfig:&{<nil> <nil> [] map[] 0x99b800 <nil> <nil> 0x99b900 <nil> <nil> []  RequireAnyClientCert <nil> false [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:7747076b59b00dde:79fc64ed6112e67d:1\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:79fc64ed6112e67d:292e9e3d997ddc68:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network services with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"Replacing Network service endpoints with: []\"\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"RegistryCache started\" operation=K8SServer.New span=\"5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:292e9e3d997ddc68:5cd2fec1226e06f2:1\ntime=\"2021-06-09T03:39:23Z\" level=info msg=\"nsmd-k8s initialized and waiting for connection\" operation=Start-NSMD-k8s span=\"5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\"\n2021/06/09 03:39:23 Reporting span 5cd2fec1226e06f2:5cd2fec1226e06f2:0000000000000000:1\nWARNING: 2021/06/09 03:39:24 [core] grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:49076\": EOF\nINFO: 2021/06/09 03:39:24 [transport] transport: loopyWriter.run returning. connection error: desc = \"transport is closing\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/RegisterNSM()=\\\"\\\" span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"==--> RegisterNSM() span:5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm={\\\"url\\\":\\\"10.244.2.90:5001\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- nsm-cr={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"creationTimestamp\\\":null,\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"CreateOrUpdateNSM attempt 0: \"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Creating NSM: &{{ } {master      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc0005235d8 0xc0005235d9}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24.3605756 +0000 UTC m=+1.508090801} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Start apply filter by namespace nsm-system for &{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}}\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkServiceManager\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058316d 0xc00058316c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Add(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- registered-nsm={\\\"metadata\\\":{\\\"name\\\":\\\"master\\\",\\\"namespace\\\":\\\"nsm-system\\\",\\\"selfLink\\\":\\\"/apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master\\\",\\\"uid\\\":\\\"d0d56e78-33f1-4755-976a-a211506b7f73\\\",\\\"resourceVersion\\\":\\\"24126\\\",\\\"generation\\\":1,\\\"creationTimestamp\\\":\\\"2021-06-09T03:39:24Z\\\",\\\"ownerReferences\\\":[{\\\"apiVersion\\\":\\\"v1\\\",\\\"kind\\\":\\\"Pod\\\",\\\"name\\\":\\\"nsmgr-1\\\",\\\"uid\\\":\\\"a0b2fca0-df91-4fb2-a4b7-338a84fe8c24\\\",\\\"controller\\\":true,\\\"blockOwnerDeletion\\\":false}]},\\\"spec\\\":{\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"expirationtime\\\":\\\"2021-06-09T03:39:24Z\\\"},\\\"status\\\":{\\\"state\\\":\\\"RUNNING\\\"}} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:770d9511b6eaade4:472bd87b186de5c7:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"NetworkServiceManagerCache.Added(&{{ } {master  nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkservicemanagers/master d0d56e78-33f1-4755-976a-a211506b7f73 24126 1 2021-06-09 03:39:24 +0000 UTC <nil> <nil> map[] map[] [{v1 Pod nsmgr-1 a0b2fca0-df91-4fb2-a4b7-338a84fe8c24 0xc00058325d 0xc00058325c}] []  []} {10.244.2.90:5001 2021-06-09 03:39:24 +0000 UTC} {RUNNING}})\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"} span=5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:472bd87b186de5c7:66ff1a5c854ae762:1\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- GRPC->/registry.NsmRegistry/GetEndpoints()=\\\"\\\" span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- request={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"Received GetEndpoints\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\"GetEndpoints return: []\"\ntime=\"2021-06-09T03:39:24Z\" level=info msg=\">><<-- response={} span=5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\"\n2021/06/09 03:39:24 Reporting span 5bbfc73e89b5d32b:034051279d8b327a:45ee12bc42c52427:1\nWARNING: 2021/06/09 03:39:25 [core] grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:49124\": EOF\nINFO: 2021/06/09 03:39:25 [transport] transport: loopyWriter.run returning. connection error: desc = \"transport is closing\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceDiscovery/FindNetworkService()=\\\"\\\" span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my_service\\\"} span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> discovery.FindNetworkService() span:04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my_service\\\"} span=04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\"\n2021/06/09 03:39:25 Reporting span 04a62398b8b8a30b:78bb90e43dec0b1d:04a62398b8b8a30b:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response=null span=04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 04a62398b8b8a30b:04a62398b8b8a30b:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceRegistry/RegisterNSE()=\\\"\\\" span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_endpoint\\\":{\\\"network_service_name\\\":\\\"my-network-service\\\"}} span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> nsmgr.RegisterNSE() span:5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Received RegisterNSE(network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_endpoint:<network_service_name:\\\"my-network-service\\\" > )\" operation=nsmgr.RegisterNSE span=\"5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkService\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Adding NSE to cache: {{ } {my-network-service7l672 my-network-service nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/my-network-service7l672 db0f5eb9-fee5-4d62-a2d8-8e4f2b56c3b8 24133 1 2021-06-09 03:39:25 +0000 UTC <nil> <nil> map[networkservicename:my-network-service] map[] [] []  []} {my-network-service tcp master} {RUNNING}}\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Add from k8s-registry: *v1alpha1.NetworkServiceEndpoint\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Returned from RegisterNSE: time: 13.8562ms request: network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_manager:<name:\\\"master\\\" url:\\\"10.244.2.90:5001\\\" state:\\\"RUNNING\\\" > network_service_endpoint:<name:\\\"my-network-service7l672\\\" payload:\\\"tcp\\\" network_service_name:\\\"my-network-service\\\" network_service_manager_name:\\\"master\\\" labels:<key:\\\"networkservicename\\\" value:\\\"my-network-service\\\" > state:\\\"RUNNING\\\" > \" operation=nsmgr.RegisterNSE span=\"5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\"\n2021/06/09 03:39:25 Reporting span 5b801670d070fff0:251fc3b123216623:5b801670d070fff0:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> ProxyNsmgr.forwardRegisterNSE() span:49e4d317789dd46c:49e4d317789dd46c:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_manager\\\":{\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"},\\\"network_service_endpoint\\\":{\\\"name\\\":\\\"my-network-service7l672\\\",\\\"payload\\\":\\\"tcp\\\",\\\"network_service_name\\\":\\\"my-network-service\\\",\\\"network_service_manager_name\\\":\\\"master\\\",\\\"labels\\\":{\\\"networkservicename\\\":\\\"my-network-service\\\"},\\\"state\\\":\\\"RUNNING\\\"}} span=5b801670d070fff0:5b801670d070fff0:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 5b801670d070fff0:5b801670d070fff0:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Forwarding Register NSE request (network_service:<name:\\\"my-network-service\\\" payload:\\\"tcp\\\" > network_service_manager:<name:\\\"master\\\" url:\\\"10.244.2.90:5001\\\" state:\\\"RUNNING\\\" > network_service_endpoint:<name:\\\"my-network-service7l672\\\" payload:\\\"tcp\\\" network_service_name:\\\"my-network-service\\\" network_service_manager_name:\\\"master\\\" labels:<key:\\\"networkservicename\\\" value:\\\"my-network-service\\\" > state:\\\"RUNNING\\\" > )\" operation=ProxyNsmgr.forwardRegisterNSE span=\"49e4d317789dd46c:49e4d317789dd46c:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Requesting NseRegistryClient...\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==----> initRegistryClient() span:49e4d317789dd46c:3d79b609f30a4a9a:49e4d317789dd46c:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Waiting for liveness probe: tcp:pnsmgr-svc:5005\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceDiscovery/FindNetworkService()=\\\"\\\" span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> discovery.FindNetworkService() span:479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"NSE found 1, retrieve time: 23.3µs\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"FindNetworkService done: time 456.1µs [my-network-service7l672]\"\n2021/06/09 03:39:25 Reporting span 479b98b284a695eb:39a7c1c0845e4a3c:479b98b284a695eb:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={\\\"payload\\\":\\\"tcp\\\",\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"},\\\"network_service_managers\\\":{\\\"master\\\":{\\\"name\\\":\\\"master\\\",\\\"url\\\":\\\"10.244.2.90:5001\\\",\\\"state\\\":\\\"RUNNING\\\"}},\\\"network_service_endpoints\\\":[{\\\"name\\\":\\\"my-network-service7l672\\\",\\\"payload\\\":\\\"tcp\\\",\\\"network_service_name\\\":\\\"my-network-service\\\",\\\"network_service_manager_name\\\":\\\"master\\\",\\\"labels\\\":{\\\"networkservicename\\\":\\\"my-network-service\\\"},\\\"state\\\":\\\"RUNNING\\\"}]} span=479b98b284a695eb:479b98b284a695eb:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 479b98b284a695eb:479b98b284a695eb:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceRegistry/RemoveNSE()=\\\"\\\" span=1d295363dfe254dd:1d295363dfe254dd:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_endpoint_name\\\":\\\"my-network-service7l672\\\"} span=1d295363dfe254dd:1d295363dfe254dd:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> ProxyNsmgr.BulkRegisterNSE() span:1d295363dfe254dd:7a582b64a728ed2e:1d295363dfe254dd:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Received RemoveNSE(network_service_endpoint_name:\\\"my-network-service7l672\\\" )\" operation=ProxyNsmgr.BulkRegisterNSE span=\"1d295363dfe254dd:7a582b64a728ed2e:1d295363dfe254dd:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"RemoveNSE done: time 9.9614ms\" operation=ProxyNsmgr.BulkRegisterNSE span=\"1d295363dfe254dd:7a582b64a728ed2e:1d295363dfe254dd:1\"\n2021/06/09 03:39:25 Reporting span 1d295363dfe254dd:7a582b64a728ed2e:1d295363dfe254dd:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={} span=1d295363dfe254dd:1d295363dfe254dd:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 1d295363dfe254dd:1d295363dfe254dd:0000000000000000:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> ProxyNsmgr.forwardRemoveNSE() span:15bdeeeeeeee1559:15bdeeeeeeee1559:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Forwarding Remove NSE request (network_service_endpoint_name:\\\"my-network-service7l672\\\" )\" operation=ProxyNsmgr.forwardRemoveNSE span=\"15bdeeeeeeee1559:15bdeeeeeeee1559:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Requesting NseRegistryClient...\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Delete from k8s-registry: *v1alpha1.NetworkServiceEndpoint\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==----> initRegistryClient() span:15bdeeeeeeee1559:1a605db09123c5de:15bdeeeeeeee1559:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"Waiting for liveness probe: tcp:pnsmgr-svc:5005\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- GRPC->/registry.NetworkServiceDiscovery/FindNetworkService()=\\\"\\\" span=3765ddfb6cd3d47d:3765ddfb6cd3d47d:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=3765ddfb6cd3d47d:3765ddfb6cd3d47d:0000000000000000:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"==--> discovery.FindNetworkService() span:3765ddfb6cd3d47d:330aec1ac7d3fcb1:3765ddfb6cd3d47d:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- request={\\\"network_service_name\\\":\\\"my-network-service\\\"} span=3765ddfb6cd3d47d:330aec1ac7d3fcb1:3765ddfb6cd3d47d:1\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"NSE found 0, retrieve time: 24.3µs\"\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\"FindNetworkService done: time 146.4µs []\"\n2021/06/09 03:39:25 Reporting span 3765ddfb6cd3d47d:330aec1ac7d3fcb1:3765ddfb6cd3d47d:1\ntime=\"2021-06-09T03:39:25Z\" level=info msg=\">><<-- response={\\\"payload\\\":\\\"tcp\\\",\\\"network_service\\\":{\\\"name\\\":\\\"my-network-service\\\",\\\"payload\\\":\\\"tcp\\\"}} span=3765ddfb6cd3d47d:3765ddfb6cd3d47d:0000000000000000:1\"\n2021/06/09 03:39:25 Reporting span 3765ddfb6cd3d47d:3765ddfb6cd3d47d:0000000000000000:1\n"
time="2021-06-08T20:39:26-07:00" level=info msg="Deleting nsmgr-1"
E0608 20:39:26.054884   39713 portforward.go:409] error closing listener: close tcp4 127.0.0.1:52917: use of closed network connection
E0608 20:39:26.054903   39713 portforward.go:409] error closing listener: close tcp6 [::1]:52917: use of closed network connection
time="2021-06-08T20:39:26-07:00" level=info msg="Deleting spire-proxy"
time="2021-06-08T20:39:26-07:00" level=info msg="Deleting prefix-service"
E0608 20:39:26.055061   39713 portforward.go:409] error closing listener: close tcp4 127.0.0.1:52914: use of closed network connection
E0608 20:39:26.057111   39713 portforward.go:409] error closing listener: close tcp6 [::1]:52914: use of closed network connection
time="2021-06-08T20:39:27-07:00" level=warning msg="The POD 'spire-proxy' Deleted 1.580985217s"
time="2021-06-08T20:39:27-07:00" level=warning msg="The POD 'prefix-service' Deleted 1.783900932s"
time="2021-06-08T20:39:41-07:00" level=info msg="The POD nsmgr-1 force deleted"
time="2021-06-08T20:39:41-07:00" level=warning msg="The POD 'nsmgr-1' Deleted 15.780508347s"
time="2021-06-08T20:39:42-07:00" level=info msg="namespace nsm-system is deleted"
time="2021-06-08T20:39:42-07:00" level=info msg="Cleanup time: 15.984527903s"
--- PASS: TestNSMDDRegistryNSE (39.46s)
PASS
ok  	github.com/networkservicemesh/networkservicemesh/test/integration	40.075s
