{"level":"info","ts":1623774302.0995777,"caller":"cmd/main.go:45","msg":"Starting application APP-DNS-Publisher...","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0997074,"caller":"utils/nsrenv.go:29","msg":"All env variables:","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.099732,"caller":"utils/nsrenv.go:31","msg":"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0997438,"caller":"utils/nsrenv.go:31","msg":"HOSTNAME=green-app-dns-publisher-77755dcc55-ddzkn","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0997665,"caller":"utils/nsrenv.go:31","msg":"POD_UID=48db96d9-df59-40a3-afb1-43ea4a229a9e","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0997787,"caller":"utils/nsrenv.go:31","msg":"INSECURE=false","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.099788,"caller":"utils/nsrenv.go:31","msg":"TRACER_ENABLED=false","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0997953,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_SERVICE_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0998032,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_HOST=10.100.198.242","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0998378,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_PORT=53","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.099851,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0998774,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_2112_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0998886,"caller":"utils/nsrenv.go:31","msg":"GREEN_SERVICE_HOST=10.104.68.169","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0999124,"caller":"utils/nsrenv.go:31","msg":"GREEN_PORT=tcp://10.104.68.169:31505","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.09992,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PORT=443","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0999272,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0999348,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_PORT=tcp://10.105.7.107:50071","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.099961,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_HOST=10.96.0.1","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.0999703,"caller":"utils/nsrenv.go:31","msg":"GREEN_PORT_31505_TCP=tcp://10.104.68.169:31505","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1,"caller":"utils/nsrenv.go:31","msg":"GREEN_PORT_31505_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1000087,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT_HTTPS=443","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1000204,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_SERVICE_HOST=10.104.97.94","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100053,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_SERVICE_PORT=50061","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1000617,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_SERVICE_PORT_GRPC_ALLOCATOR=50051","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1000695,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50051_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1001048,"caller":"utils/nsrenv.go:31","msg":"GREEN_SERVICE_PORT_GRPC_NSR=31505","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100114,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_CLIENT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100148,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50051_TCP_PORT=50051","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1001568,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP=udp://10.111.94.51:53","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1001637,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_PORT_50071_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1001759,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP=tcp://10.104.97.94:2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100242,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50051_TCP=tcp://10.99.87.102:50051","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100281,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_SERVICE_PORT=53","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1003327,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50061_TCP=tcp://10.99.87.102:50061","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1003952,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50061_TCP_PORT=50061","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1008039,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_SERVICE_HOST=10.105.7.107","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.100904,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_PORT_50071_TCP=tcp://10.105.7.107:50071","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1009135,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_SERVICE_PORT_MONITORING=2112","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1009207,"caller":"utils/nsrenv.go:31","msg":"GREEN_PORT_31505_TCP_PORT=31505","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1009367,"caller":"utils/nsrenv.go:31","msg":"GREEN_PORT_31505_TCP_ADDR=10.104.68.169","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1009433,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_SERVICE_HOST=10.111.94.51","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101015,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_PORT_50071_TCP_PORT=50071","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1010354,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT=tcp://10.96.0.1:443","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101074,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50061_TCP_ADDR=10.99.87.102","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1010847,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_2112_TCP=tcp://10.99.87.102:2112","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1010914,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT=443","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1010976,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101103,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_PORT_50071_TCP_ADDR=10.105.7.107","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.10111,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_ADDR=10.104.97.94","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011176,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011248,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_SERVICE_PORT=50071","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011314,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011376,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_SERVICE_HOST=10.99.87.102","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011686,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_PROTO=udp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1011784,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_ADDR=10.100.198.242","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1012635,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT=tcp://10.99.87.102:50061","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1012957,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50061_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1013107,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_50051_TCP_ADDR=10.99.87.102","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101322,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_ADDR=10.111.94.51","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1013284,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT=udp://10.111.94.51:53","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101335,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1013687,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1013978,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP=tcp://10.100.198.242:2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1014266,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_2112_TCP_PORT=2112","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1014888,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_PORT_2112_TCP_ADDR=10.99.87.102","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1014986,"caller":"utils/nsrenv.go:31","msg":"GREEN_SERVICE_PORT=31505","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101532,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101555,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT=tcp://10.100.198.242:2379","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1015635,"caller":"utils/nsrenv.go:31","msg":"GREEN_WCMD_SERVICE_PORT_GRPC_REGISTRY=50061","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.1015708,"caller":"utils/nsrenv.go:31","msg":"GREEN_CD_INFO_SERVICE_PORT_INFO_HTTP=50071","app":"app-dns-publisher"}
{"level":"info","ts":1623774302.101578,"caller":"utils/nsrenv.go:31","msg":"HOME=/root","app":"app-dns-publisher"}
W0615 16:25:02.101638       1 client_config.go:543] Neither --kubeconfig nor --master was specified.  Using the inClusterConfig.  This might not work.
{"level":"info","ts":1623774302.1022155,"caller":"controller/controller.go:142","msg":"Waiting for connection to be ready. Connecting to green-wcmd:50051","app":"app-dns-publisher"}
time="2021-06-15T16:25:02Z" level=info msg="Trying to establish connection to target: green-wcmd:50051"
time="2021-06-15T16:25:02Z" level=info msg="Establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock"
time="2021-06-15T16:25:02Z" level=info msg="Got x509:&{0xc0004207e0 <nil> {{0 0} 0 0 0 0} 0xc0002f4730 0xc0004e4cc0 {{0 0} 0 0 0 0} false} <nil>"
time="2021-06-15T16:25:02Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-15T16:25:02Z" level=info msg="Issued identity:spiffe://central.com/green-app-dns-publisher"
time="2021-06-15T16:25:02Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc00018a140 {member1.com}:0xc00018a200 {member2.com}:0xc00018a2c0]}"
time="2021-06-15T16:25:02Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-15T16:25:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-15T16:25:02Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-15T16:25:02Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-15T16:25:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-15T16:25:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-15T16:25:02Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-15T16:25:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-15T16:25:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-15T16:25:02Z" level=info msg="Found 3 tlsconfigs."
time="2021-06-15T16:25:32Z" level=error msg="None of the tls certificates worked: <nil>"
time="2021-06-15T16:25:32Z" level=info msg="Trying to establish connection using tlsConfig:<nil>"
time="2021-06-15T16:25:32Z" level=error msg="Error occurred while trying to establish connection to: green-wcmd:50051. Error: context deadline exceeded"
{"level":"error","ts":1623774332.6759603,"caller":"controller/controller.go:145","msg":"unable to connect to server: context deadline exceeded","app":"app-dns-publisher","stacktrace":"cisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewClient\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/pkg/controller/controller.go:145\ncisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewController\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/pkg/controller/controller.go:98\nmain.glob..func1\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:51\ngithub.com/spf13/cobra.(*Command).execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:204"}
{"level":"error","ts":1623774332.6760724,"caller":"controller/controller.go:100","msg":"error creating new service registry client, err context deadline exceeded","app":"app-dns-publisher","stacktrace":"cisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewController\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/pkg/controller/controller.go:100\nmain.glob..func1\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:51\ngithub.com/spf13/cobra.(*Command).execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:204"}
{"level":"error","ts":1623774332.676134,"caller":"cmd/main.go:54","msg":"could not create watcher, err:%!(EXTRA context.deadlineExceededError=context deadline exceeded)","app":"app-dns-publisher","stacktrace":"main.glob..func1\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:54\ngithub.com/spf13/cobra.(*Command).execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/Users/nispatil/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:204"}
Error: context deadline exceeded
{"level":"error","ts":1623774332.6761987,"caller":"cmd/main.go:89","msg":"context deadline exceeded","app":"app-dns-publisher","stacktrace":"main.main\n\t/Users/nispatil/go/src/github.com/cisco-app-networking/wcm-common/app-dns-publisher/cmd/main.go:89\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:204"}
