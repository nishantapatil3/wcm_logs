==== START logs for container wcm-nse-discovery of pod wcm-system/wcm-nse-discovery-5f68d85698-8shgw ====
{"level":"info","ts":1623862937.0723677,"caller":"cmd/main.go:45","msg":"Starting WCM nse-discovery...","app":"nse-discovery"}
{"level":"info","ts":1623862937.0746627,"caller":"utils/nsrenv.go:29","msg":"All env variables:","app":"nse-discovery"}
{"level":"info","ts":1623862937.0746765,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_PORT=tcp://10.105.148.193:2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.0746853,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_SERVICE_PORT=2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.0746932,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_SERVICE_PORT_HTTP_METRICS=8383","app":"nse-discovery"}
{"level":"info","ts":1623862937.074704,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_SERVICE_HOST=10.107.127.11","app":"nse-discovery"}
{"level":"info","ts":1623862937.074714,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT=443","app":"nse-discovery"}
{"level":"info","ts":1623862937.074725,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT=tcp://10.96.0.1:443","app":"nse-discovery"}
{"level":"info","ts":1623862937.0747318,"caller":"utils/nsrenv.go:31","msg":"NSE_NAMESPACE=wcm-system","app":"nse-discovery"}
{"level":"info","ts":1623862937.0747406,"caller":"utils/nsrenv.go:31","msg":"METRICS_PORT=2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.074747,"caller":"utils/nsrenv.go:31","msg":"HOSTNAME=wcm-nse-discovery-5f68d85698-8shgw","app":"nse-discovery"}
{"level":"info","ts":1623862937.0747728,"caller":"utils/nsrenv.go:31","msg":"SHLVL=1","app":"nse-discovery"}
{"level":"info","ts":1623862937.0747797,"caller":"utils/nsrenv.go:31","msg":"HOME=/root","app":"nse-discovery"}
{"level":"info","ts":1623862937.0747862,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8383_TCP_ADDR=10.107.127.11","app":"nse-discovery"}
{"level":"info","ts":1623862937.074797,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT=tcp://10.107.127.11:8383","app":"nse-discovery"}
{"level":"info","ts":1623862937.0748034,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_SERVICE_PORT=8383","app":"nse-discovery"}
{"level":"info","ts":1623862937.0748281,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8383_TCP_PORT=8383","app":"nse-discovery"}
{"level":"info","ts":1623862937.0748565,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_SERVICE_PORT_MONITORING=2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.074863,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8383_TCP_PROTO=tcp","app":"nse-discovery"}
{"level":"info","ts":1623862937.0748692,"caller":"utils/nsrenv.go:31","msg":"CLUSTER_NAME=member2","app":"nse-discovery"}
{"level":"info","ts":1623862937.074889,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8686_TCP_ADDR=10.107.127.11","app":"nse-discovery"}
{"level":"info","ts":1623862937.074905,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8686_TCP_PORT=8686","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749316,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8686_TCP_PROTO=tcp","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749397,"caller":"utils/nsrenv.go:31","msg":"INSECURE=false","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749466,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8383_TCP=tcp://10.107.127.11:8383","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749748,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749834,"caller":"utils/nsrenv.go:31","msg":"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","app":"nse-discovery"}
{"level":"info","ts":1623862937.0749907,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PORT=443","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750213,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_PORT_2112_TCP_ADDR=10.105.148.193","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750303,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PROTO=tcp","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750375,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_SERVICE_PORT_CR_METRICS=8686","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750446,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_OPERATOR_METRICS_PORT_8686_TCP=tcp://10.107.127.11:8686","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750523,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_PORT_2112_TCP_PORT=2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.075059,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_PORT_2112_TCP_PROTO=tcp","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750837,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443","app":"nse-discovery"}
{"level":"info","ts":1623862937.0750928,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT_HTTPS=443","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_SERVICE_HOST=10.105.148.193","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751066,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_HOST=10.96.0.1","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751388,"caller":"utils/nsrenv.go:31","msg":"PWD=/","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751472,"caller":"utils/nsrenv.go:31","msg":"POD_UID=6aa78266-2a42-4378-92dc-201d85bfe294","app":"nse-discovery"}
{"level":"info","ts":1623862937.075154,"caller":"utils/nsrenv.go:31","msg":"WCM_NSE_DISCOVERY_PORT_2112_TCP=tcp://10.105.148.193:2112","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751615,"caller":"utils/nsrenv.go:31","msg":"NSR_ADDRESS=wcm-proxy-nsmgr.nsm-system:5005","app":"nse-discovery"}
{"level":"info","ts":1623862937.0751753,"caller":"metrics/metrics.go:56","msg":"Serving metrics","app":"nse-discovery"}
time="2021-06-16T17:02:17Z" level=info msg="Creating logger from config: &{wcm-nse-discovery.tpl@wcm-nse-discovery-5f68d85698-8shgw false false [] 0xc00008dc80 0xc000457340 <nil> <nil> <nil>}"
2021/06/16 17:02:17 debug logging disabled
2021/06/16 17:02:17 Initializing logging reporter
2021/06/16 17:02:17 debug logging disabled
{"level":"info","ts":1623862937.1013186,"caller":"nseinformer/nseInformerController.go:61","msg":"Creating NSE CR controller","app":"nse-discovery"}
{"level":"info","ts":1623862937.1026912,"caller":"nseinformer/nseInformerController.go:83","msg":"Created new informer for NSE pod controller","app":"nse-discovery"}
{"level":"info","ts":1623862937.1027703,"caller":"nseinformer/nseInformerController.go:123","msg":"starting NSE pod controller","app":"nse-discovery"}
{"level":"info","ts":1623863151.3667636,"caller":"nseinformer/nseInformerController.go:98","msg":"new NSE CR was created: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863151.3669286,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863151.3670259,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863151.3671284,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:05:51Z" level=info msg="==--> discovery.FindNetworkService() span:19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
time="2021-06-16T17:05:51Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
time="2021-06-16T17:05:51Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
time="2021-06-16T17:05:51Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:05:51Z" level=info msg="==----> initRegistryClient() span:19a3de165a130d90:061ab0c8f7168279:19a3de165a130d90:1"
time="2021-06-16T17:05:51Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:05:51Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:05:51Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="19a3de165a130d90:061ab0c8f7168279:19a3de165a130d90:1"
time="2021-06-16T17:05:51Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:05:51Z" level=info msg="Establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:05:51Z" level=info msg="Got x509:&{0xc0002461b0 <nil> {{0 0} 0 0 0 0} 0xc000229130 0xc000579060 {{0 0} 0 0 0 0} false} <nil>"
time="2021-06-16T17:05:51Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:05:51Z" level=info msg="Issued identity:spiffe://member2.com/wcm-nse-discovery"
time="2021-06-16T17:05:51Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b08c0 {member1.com}:0xc0001b0940 {member2.com}:0xc0001b0840]}"
time="2021-06-16T17:05:51Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:05:51Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:05:51Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:05:51Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:05:51Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:05:51Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:05:51Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:05:51Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:05:51Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:05:51Z" level=info msg="Found 3 tlsconfigs. [0xc0004f7680 0xc0004f7800 0xc0004f7c80]"
time="2021-06-16T17:05:51Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
{"level":"info","ts":1623863152.4299667,"caller":"nseinformer/nseInformerController.go:98","msg":"new NSE CR was created: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
time="2021-06-16T17:05:56Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:05:56Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:01Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:01Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:01Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="19a3de165a130d90:061ab0c8f7168279:19a3de165a130d90:1"
2021/06/16 17:06:01 Reporting span 19a3de165a130d90:061ab0c8f7168279:19a3de165a130d90:1
{"level":"info","ts":1623863161.5107353,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:01Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
2021/06/16 17:06:01 Reporting span 19a3de165a130d90:444cba3bb3de7953:19a3de165a130d90:1
time="2021-06-16T17:06:01Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=19a3de165a130d90:19a3de165a130d90:0000000000000000:1"
2021/06/16 17:06:01 Reporting span 19a3de165a130d90:19a3de165a130d90:0000000000000000:1
{"level":"info","ts":1623863161.519861,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863161.519892,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863161.5199199,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863161.519962,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:06:01Z" level=info msg="==--> discovery.FindNetworkService() span:6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:01Z" level=info msg="==----> initRegistryClient() span:6b79951efffd032c:525af610bd690c92:6b79951efffd032c:1"
time="2021-06-16T17:06:01Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="6b79951efffd032c:525af610bd690c92:6b79951efffd032c:1"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:01Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000254d80 {member1.com}:0xc000254e00 {member2.com}:0xc000254d00]}"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:01Z" level=info msg="Found 3 tlsconfigs. [0xc0005a0d80 0xc0005a0f00 0xc0005a1080]"
time="2021-06-16T17:06:01Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:01Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="6b79951efffd032c:525af610bd690c92:6b79951efffd032c:1"
2021/06/16 17:06:01 Reporting span 6b79951efffd032c:525af610bd690c92:6b79951efffd032c:1
{"level":"info","ts":1623863161.5629318,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:01Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
2021/06/16 17:06:01 Reporting span 6b79951efffd032c:063806d9df3707a7:6b79951efffd032c:1
time="2021-06-16T17:06:01Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=6b79951efffd032c:6b79951efffd032c:0000000000000000:1"
2021/06/16 17:06:01 Reporting span 6b79951efffd032c:6b79951efffd032c:0000000000000000:1
{"level":"info","ts":1623863161.5663667,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863161.5665853,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863161.5666225,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 2 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863161.5667772,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5669014,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863161.566974,"caller":"nseinformer/nseInformerController.go:338","msg":"NSE diff: For cluster member2, found diff endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5670333,"caller":"nseinformer/nseInformerController.go:338","msg":"NSE diff: For cluster member2, found diff endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5670762,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5671015,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5671136,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5671232,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863161.5671344,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 2 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
time="2021-06-16T17:06:01Z" level=info msg="Requesting NseRegistryClient..."
time="2021-06-16T17:06:01Z" level=info msg="==--> initRegistryClient() span:7b8e6fc5cf3da83f:7b8e6fc5cf3da83f:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="7b8e6fc5cf3da83f:7b8e6fc5cf3da83f:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:01Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:01Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc00037a100 {member1.com}:0xc00037a180 {member2.com}:0xc00037a080]}"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:01Z" level=info msg="Found 3 tlsconfigs. [0xc000202300 0xc000202480 0xc000202600]"
time="2021-06-16T17:06:01Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:01Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:01Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="7b8e6fc5cf3da83f:7b8e6fc5cf3da83f:0000000000000000:1"
2021/06/16 17:06:01 Reporting span 7b8e6fc5cf3da83f:7b8e6fc5cf3da83f:0000000000000000:1
time="2021-06-16T17:06:01Z" level=info msg=">><<-- /registry.NetworkServiceRegistry/RegisterNSE()=\"\" span=<nil>"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- request={\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_manager\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"},\"network_service_endpoint\":{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}} span=<nil>"
2021/06/16 17:06:01 Reporting span 711425611ed76cd0:711425611ed76cd0:0000000000000000:1
time="2021-06-16T17:06:01Z" level=info msg=">><<-- response={\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_manager\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"},\"network_service_endpoint\":{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}} span=<nil>"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- /registry.NetworkServiceRegistry/RegisterNSE()=\"\" span=<nil>"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- request={\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_manager\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"},\"network_service_endpoint\":{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}} span=<nil>"
2021/06/16 17:06:01 Reporting span 420bf06c93f34e3b:420bf06c93f34e3b:0000000000000000:1
time="2021-06-16T17:06:01Z" level=info msg=">><<-- response={\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_manager\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"},\"network_service_endpoint\":{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}} span=<nil>"
{"level":"info","ts":1623863161.6157906,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863161.6158733,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863161.6159449,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863161.6159582,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:06:01Z" level=info msg="==--> discovery.FindNetworkService() span:2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
time="2021-06-16T17:06:01Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:01Z" level=info msg="==----> initRegistryClient() span:2f3174f8d76b3733:0e707fdda0d37ff5:2f3174f8d76b3733:1"
time="2021-06-16T17:06:01Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:01Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:01Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="2f3174f8d76b3733:0e707fdda0d37ff5:2f3174f8d76b3733:1"
time="2021-06-16T17:06:01Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:01Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:01Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b1840 {member1.com}:0xc0001b18c0 {member2.com}:0xc0001b17c0]}"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:01Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:01Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:01Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:01Z" level=info msg="Found 3 tlsconfigs. [0xc000083980 0xc000083b00 0xc000083e00]"
time="2021-06-16T17:06:01Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:06Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:06Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:11Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:11Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:11Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:11Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:11Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="2f3174f8d76b3733:0e707fdda0d37ff5:2f3174f8d76b3733:1"
2021/06/16 17:06:11 Reporting span 2f3174f8d76b3733:0e707fdda0d37ff5:2f3174f8d76b3733:1
{"level":"info","ts":1623863171.6503682,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:11Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
time="2021-06-16T17:06:11Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
2021/06/16 17:06:11 Reporting span 2f3174f8d76b3733:613e40919aacd808:2f3174f8d76b3733:1
time="2021-06-16T17:06:11Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1"
2021/06/16 17:06:11 Reporting span 2f3174f8d76b3733:2f3174f8d76b3733:0000000000000000:1
{"level":"info","ts":1623863171.6564684,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863171.6564996,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863171.6565318,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863171.656544,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:06:11Z" level=info msg="==--> discovery.FindNetworkService() span:7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
time="2021-06-16T17:06:11Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
time="2021-06-16T17:06:11Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
time="2021-06-16T17:06:11Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:11Z" level=info msg="==----> initRegistryClient() span:7015622b0e7bd65d:69d5863db7a9cf0a:7015622b0e7bd65d:1"
time="2021-06-16T17:06:11Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:11Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:11Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="7015622b0e7bd65d:69d5863db7a9cf0a:7015622b0e7bd65d:1"
time="2021-06-16T17:06:11Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:11Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:11Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0000ab940 {member1.com}:0xc0000ab9c0 {member2.com}:0xc0000ab8c0]}"
time="2021-06-16T17:06:11Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:11Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:11Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:11Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:11Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:11Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:11Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:11Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:11Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:11Z" level=info msg="Found 3 tlsconfigs. [0xc000659800 0xc000659980 0xc000659b00]"
time="2021-06-16T17:06:11Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:11Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:11Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:11Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="7015622b0e7bd65d:69d5863db7a9cf0a:7015622b0e7bd65d:1"
2021/06/16 17:06:11 Reporting span 7015622b0e7bd65d:69d5863db7a9cf0a:7015622b0e7bd65d:1
{"level":"info","ts":1623863171.697152,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:11Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
time="2021-06-16T17:06:11Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
2021/06/16 17:06:11 Reporting span 7015622b0e7bd65d:7ceeee5193416e72:7015622b0e7bd65d:1
time="2021-06-16T17:06:11Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1"
2021/06/16 17:06:11 Reporting span 7015622b0e7bd65d:7015622b0e7bd65d:0000000000000000:1
{"level":"info","ts":1623863171.7026913,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863171.7028258,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863171.7028906,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029188,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863171.702931,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029448,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029538,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029624,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029715,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029805,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7029893,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7030337,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7030666,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7031195,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7031536,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863171.703242,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863171.7032797,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863171.703366,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863171.7034125,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863171.703457,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863177.1282053,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863177.1283438,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863177.1283762,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863177.1283891,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:06:17Z" level=info msg="==--> discovery.FindNetworkService() span:0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
time="2021-06-16T17:06:17Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
time="2021-06-16T17:06:17Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
time="2021-06-16T17:06:17Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:17Z" level=info msg="==----> initRegistryClient() span:0fa2f875182b8cdc:0c900f6bb232db1d:0fa2f875182b8cdc:1"
time="2021-06-16T17:06:17Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
{"level":"info","ts":1623863177.1287186,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
time="2021-06-16T17:06:17Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:17Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="0fa2f875182b8cdc:0c900f6bb232db1d:0fa2f875182b8cdc:1"
time="2021-06-16T17:06:17Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:17Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:17Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000075580 {member1.com}:0xc000075600 {member2.com}:0xc000075500]}"
time="2021-06-16T17:06:17Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:17Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:17Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:17Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:17Z" level=info msg="Found 3 tlsconfigs. [0xc000001b00 0xc000001c80 0xc000001e00]"
time="2021-06-16T17:06:17Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:22Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:22Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:27Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:27Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:27Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="0fa2f875182b8cdc:0c900f6bb232db1d:0fa2f875182b8cdc:1"
2021/06/16 17:06:27 Reporting span 0fa2f875182b8cdc:0c900f6bb232db1d:0fa2f875182b8cdc:1
{"level":"info","ts":1623863187.1601987,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
2021/06/16 17:06:27 Reporting span 0fa2f875182b8cdc:5b396e79606d1110:0fa2f875182b8cdc:1
time="2021-06-16T17:06:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1"
2021/06/16 17:06:27 Reporting span 0fa2f875182b8cdc:0fa2f875182b8cdc:0000000000000000:1
{"level":"info","ts":1623863187.1675045,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863187.1683264,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863187.1683438,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863187.1683817,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:06:27Z" level=info msg="==--> discovery.FindNetworkService() span:160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:27Z" level=info msg="==----> initRegistryClient() span:160cacd7456fdd80:157ec486a3e5aaf4:160cacd7456fdd80:1"
time="2021-06-16T17:06:27Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:27Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="160cacd7456fdd80:157ec486a3e5aaf4:160cacd7456fdd80:1"
time="2021-06-16T17:06:27Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000075180 {member1.com}:0xc000075200 {member2.com}:0xc000075100]}"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:27Z" level=info msg="Found 3 tlsconfigs. [0xc00058ad80 0xc00058af00 0xc00058b080]"
time="2021-06-16T17:06:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:27Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="160cacd7456fdd80:157ec486a3e5aaf4:160cacd7456fdd80:1"
2021/06/16 17:06:27 Reporting span 160cacd7456fdd80:157ec486a3e5aaf4:160cacd7456fdd80:1
{"level":"info","ts":1623863187.2307093,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
2021/06/16 17:06:27 Reporting span 160cacd7456fdd80:3bd03dbd654b16cd:160cacd7456fdd80:1
time="2021-06-16T17:06:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1"
2021/06/16 17:06:27 Reporting span 160cacd7456fdd80:160cacd7456fdd80:0000000000000000:1
{"level":"info","ts":1623863187.2355323,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863187.2355888,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863187.2356024,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863187.2356117,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863187.2356217,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863187.2358725,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2359061,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2359166,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2359254,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2362635,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2362995,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2363095,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863187.236355,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2364986,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2365901,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2366288,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2367203,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863187.2368157,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863187.2368424,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863187.236853,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863187.2368684,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863187.2368765,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863187.2368855,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:06:27Z" level=info msg="==--> discovery.FindNetworkService() span:3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
time="2021-06-16T17:06:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:27Z" level=info msg="==----> initRegistryClient() span:3baa672865ba42b1:1b0f62738f29d130:3baa672865ba42b1:1"
time="2021-06-16T17:06:27Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:27Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="3baa672865ba42b1:1b0f62738f29d130:3baa672865ba42b1:1"
time="2021-06-16T17:06:27Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:06:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000254e00 {member1.com}:0xc000254d80 {member2.com}:0xc000254d00]}"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:27Z" level=info msg="Found 3 tlsconfigs. [0xc0005a0d80 0xc0005a0f00 0xc0005a1080]"
time="2021-06-16T17:06:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:32Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:32Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:37Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:06:37Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:37Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:37Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:37Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="3baa672865ba42b1:1b0f62738f29d130:3baa672865ba42b1:1"
2021/06/16 17:06:37 Reporting span 3baa672865ba42b1:1b0f62738f29d130:3baa672865ba42b1:1
{"level":"info","ts":1623863197.2668185,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:37Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
time="2021-06-16T17:06:37Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
2021/06/16 17:06:37 Reporting span 3baa672865ba42b1:6d92caf0928578b6:3baa672865ba42b1:1
time="2021-06-16T17:06:37Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1"
2021/06/16 17:06:37 Reporting span 3baa672865ba42b1:3baa672865ba42b1:0000000000000000:1
{"level":"info","ts":1623863197.2717967,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863197.2719414,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863197.2719572,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863197.2720292,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:06:37Z" level=info msg="==--> discovery.FindNetworkService() span:2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
time="2021-06-16T17:06:37Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
time="2021-06-16T17:06:37Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
time="2021-06-16T17:06:37Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:06:37Z" level=info msg="==----> initRegistryClient() span:2798bbee8639d281:42497efad49b85de:2798bbee8639d281:1"
time="2021-06-16T17:06:37Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:37Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:37Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="2798bbee8639d281:42497efad49b85de:2798bbee8639d281:1"
time="2021-06-16T17:06:37Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:06:37Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:06:37Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000103f80 {member1.com}:0xc00037a000 {member2.com}:0xc000103f00]}"
time="2021-06-16T17:06:37Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:06:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:37Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:06:37Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:06:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:06:37Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:06:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:06:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:06:37Z" level=info msg="Found 3 tlsconfigs. [0xc000677980 0xc000677b00 0xc000677c80]"
time="2021-06-16T17:06:37Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:06:37Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:37Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:06:37Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="2798bbee8639d281:42497efad49b85de:2798bbee8639d281:1"
2021/06/16 17:06:37 Reporting span 2798bbee8639d281:42497efad49b85de:2798bbee8639d281:1
{"level":"info","ts":1623863197.3091855,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:06:37Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
time="2021-06-16T17:06:37Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
2021/06/16 17:06:37 Reporting span 2798bbee8639d281:5fb045ab3bc6c47a:2798bbee8639d281:1
time="2021-06-16T17:06:37Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=2798bbee8639d281:2798bbee8639d281:0000000000000000:1"
2021/06/16 17:06:37 Reporting span 2798bbee8639d281:2798bbee8639d281:0000000000000000:1
{"level":"info","ts":1623863197.3126073,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863197.3127375,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863197.3128328,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863197.3129268,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863197.3130453,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863197.3133695,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3134794,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3136623,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3137987,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3139174,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3140798,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863197.314111,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3141193,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3141274,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863197.314135,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863197.314143,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863197.3141506,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863197.314161,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863197.31417,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863197.3141778,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863297.12858,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863297.1287124,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863297.1287827,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863297.128796,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:08:17Z" level=info msg="==--> discovery.FindNetworkService() span:03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
time="2021-06-16T17:08:17Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
time="2021-06-16T17:08:17Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
time="2021-06-16T17:08:17Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:08:17Z" level=info msg="==----> initRegistryClient() span:03339a0a6c1bd7aa:28eef7de9a42d49c:03339a0a6c1bd7aa:1"
time="2021-06-16T17:08:17Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
{"level":"info","ts":1623863297.1288407,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
time="2021-06-16T17:08:17Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:08:17Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="03339a0a6c1bd7aa:28eef7de9a42d49c:03339a0a6c1bd7aa:1"
time="2021-06-16T17:08:17Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:08:17Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:08:17Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc00037b680 {member1.com}:0xc00037b700 {member2.com}:0xc00037b600]}"
time="2021-06-16T17:08:17Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:08:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:17Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:08:17Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:08:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:08:17Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:08:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:08:17Z" level=info msg="Found 3 tlsconfigs. [0xc000676000 0xc000676180 0xc000676300]"
time="2021-06-16T17:08:17Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:22Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:08:22Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:27Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:08:27Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:27Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="03339a0a6c1bd7aa:28eef7de9a42d49c:03339a0a6c1bd7aa:1"
2021/06/16 17:08:27 Reporting span 03339a0a6c1bd7aa:28eef7de9a42d49c:03339a0a6c1bd7aa:1
{"level":"info","ts":1623863307.1827497,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:08:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
2021/06/16 17:08:27 Reporting span 03339a0a6c1bd7aa:479ba805bd7ca422:03339a0a6c1bd7aa:1
time="2021-06-16T17:08:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1"
2021/06/16 17:08:27 Reporting span 03339a0a6c1bd7aa:03339a0a6c1bd7aa:0000000000000000:1
{"level":"info","ts":1623863307.1894088,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863307.189503,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863307.189571,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863307.1896276,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:08:27Z" level=info msg="==--> discovery.FindNetworkService() span:18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:08:27Z" level=info msg="==----> initRegistryClient() span:18f69d87844ac738:4d144039c5c6daef:18f69d87844ac738:1"
time="2021-06-16T17:08:27Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:27Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="18f69d87844ac738:4d144039c5c6daef:18f69d87844ac738:1"
time="2021-06-16T17:08:27Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:08:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b0280 {member1.com}:0xc0001b0300 {member2.com}:0xc0001b0200]}"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:08:27Z" level=info msg="Found 3 tlsconfigs. [0xc00058a000 0xc00058a180 0xc00058a300]"
time="2021-06-16T17:08:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:27Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="18f69d87844ac738:4d144039c5c6daef:18f69d87844ac738:1"
2021/06/16 17:08:27 Reporting span 18f69d87844ac738:4d144039c5c6daef:18f69d87844ac738:1
{"level":"info","ts":1623863307.2377396,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:08:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
2021/06/16 17:08:27 Reporting span 18f69d87844ac738:5762d59af6558797:18f69d87844ac738:1
time="2021-06-16T17:08:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=18f69d87844ac738:18f69d87844ac738:0000000000000000:1"
2021/06/16 17:08:27 Reporting span 18f69d87844ac738:18f69d87844ac738:0000000000000000:1
{"level":"info","ts":1623863307.2399929,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400117,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863307.24002,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400272,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400346,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400444,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400522,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400584,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400653,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863307.240072,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400784,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863307.240085,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2400916,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401004,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863307.240109,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401175,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401283,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863307.240136,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863307.240144,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401524,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401671,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401764,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863307.2401855,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:08:27Z" level=info msg="==--> discovery.FindNetworkService() span:4256112682b33400:4256112682b33400:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=4256112682b33400:4256112682b33400:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=4256112682b33400:4256112682b33400:0000000000000000:1"
time="2021-06-16T17:08:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:08:27Z" level=info msg="==----> initRegistryClient() span:4256112682b33400:762c2e8397d63015:4256112682b33400:1"
time="2021-06-16T17:08:27Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:08:27Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:08:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="4256112682b33400:762c2e8397d63015:4256112682b33400:1"
time="2021-06-16T17:08:27Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:08:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:08:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b1200 {member1.com}:0xc0001b1140 {member2.com}:0xc0001b10c0]}"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:08:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:08:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:08:27Z" level=info msg="Found 3 tlsconfigs. [0xc00058bc80 0xc000202300 0xc000202780]"
time="2021-06-16T17:08:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:32Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:08:32Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:37Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:08:37Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:37Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:37Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:37Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="4256112682b33400:762c2e8397d63015:4256112682b33400:1"
2021/06/16 17:08:37 Reporting span 4256112682b33400:762c2e8397d63015:4256112682b33400:1
{"level":"info","ts":1623863317.2705045,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:08:37Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=4256112682b33400:4256112682b33400:0000000000000000:1"
time="2021-06-16T17:08:37Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=4256112682b33400:4256112682b33400:0000000000000000:1"
2021/06/16 17:08:37 Reporting span 4256112682b33400:74d35c712a3f549c:4256112682b33400:1
time="2021-06-16T17:08:37Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=4256112682b33400:4256112682b33400:0000000000000000:1"
2021/06/16 17:08:37 Reporting span 4256112682b33400:4256112682b33400:0000000000000000:1
{"level":"info","ts":1623863317.2754424,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863317.2754726,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863317.275484,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863317.2754943,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:08:37Z" level=info msg="==--> discovery.FindNetworkService() span:1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
time="2021-06-16T17:08:37Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
time="2021-06-16T17:08:37Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
time="2021-06-16T17:08:37Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:08:37Z" level=info msg="==----> initRegistryClient() span:1576fc48f4a62475:013c9a1175117505:1576fc48f4a62475:1"
time="2021-06-16T17:08:37Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:37Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:37Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="1576fc48f4a62475:013c9a1175117505:1576fc48f4a62475:1"
time="2021-06-16T17:08:37Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:08:37Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:08:37Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc00037ad40 {member1.com}:0xc00037adc0 {member2.com}:0xc00037acc0]}"
time="2021-06-16T17:08:37Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:08:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:37Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:08:37Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:08:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:08:37Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:08:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:08:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:08:37Z" level=info msg="Found 3 tlsconfigs. [0xc000083680 0xc000083800 0xc000083980]"
time="2021-06-16T17:08:37Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:08:37Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:37Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:08:37Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="1576fc48f4a62475:013c9a1175117505:1576fc48f4a62475:1"
2021/06/16 17:08:37 Reporting span 1576fc48f4a62475:013c9a1175117505:1576fc48f4a62475:1
{"level":"info","ts":1623863317.318759,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:08:37Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
time="2021-06-16T17:08:37Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
2021/06/16 17:08:37 Reporting span 1576fc48f4a62475:18582c23d4e5680f:1576fc48f4a62475:1
time="2021-06-16T17:08:37Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1"
2021/06/16 17:08:37 Reporting span 1576fc48f4a62475:1576fc48f4a62475:0000000000000000:1
{"level":"info","ts":1623863317.322936,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863317.3231828,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863317.3231964,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863317.323206,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863317.3232162,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863317.323236,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863317.323267,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233008,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233342,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233461,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233562,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863317.323366,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233743,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233817,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3233907,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3234248,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863317.3234375,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863317.323447,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863317.3234553,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863317.3234842,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863417.1288893,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863417.129043,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863417.129089,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863417.1291144,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863417.1291265,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:10:17Z" level=info msg="==--> discovery.FindNetworkService() span:6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
time="2021-06-16T17:10:17Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
time="2021-06-16T17:10:17Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
time="2021-06-16T17:10:17Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:10:17Z" level=info msg="==----> initRegistryClient() span:6b77b3a07edc732e:4bd9ad7838c8c924:6b77b3a07edc732e:1"
time="2021-06-16T17:10:17Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:17Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:17Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="6b77b3a07edc732e:4bd9ad7838c8c924:6b77b3a07edc732e:1"
time="2021-06-16T17:10:17Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:17Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:10:17Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000102440 {member1.com}:0xc000102300 {member2.com}:0xc000102000]}"
time="2021-06-16T17:10:17Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:10:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:17Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:10:17Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:10:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:10:17Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:10:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:10:17Z" level=info msg="Found 3 tlsconfigs. [0xc00058ad80 0xc00058af00 0xc00058b080]"
time="2021-06-16T17:10:17Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:22Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:10:22Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:27Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:10:27Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:10:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:10:27Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="6b77b3a07edc732e:4bd9ad7838c8c924:6b77b3a07edc732e:1"
2021/06/16 17:10:27 Reporting span 6b77b3a07edc732e:4bd9ad7838c8c924:6b77b3a07edc732e:1
{"level":"info","ts":1623863427.168115,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:10:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
time="2021-06-16T17:10:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
2021/06/16 17:10:27 Reporting span 6b77b3a07edc732e:6823c64116c9ae11:6b77b3a07edc732e:1
time="2021-06-16T17:10:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1"
2021/06/16 17:10:27 Reporting span 6b77b3a07edc732e:6b77b3a07edc732e:0000000000000000:1
{"level":"info","ts":1623863427.1743915,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863427.1745334,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863427.1745982,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863427.1746116,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:10:27Z" level=info msg="==--> discovery.FindNetworkService() span:4cb87b1a9c78eb5a:4cb87b1a9c78eb5a:0000000000000000:1"
time="2021-06-16T17:10:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=4cb87b1a9c78eb5a:4cb87b1a9c78eb5a:0000000000000000:1"
time="2021-06-16T17:10:27Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=4cb87b1a9c78eb5a:4cb87b1a9c78eb5a:0000000000000000:1"
time="2021-06-16T17:10:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:10:27Z" level=info msg="==----> initRegistryClient() span:4cb87b1a9c78eb5a:074e665b09393a8d:4cb87b1a9c78eb5a:1"
time="2021-06-16T17:10:27Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:10:37Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:10:37Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="4cb87b1a9c78eb5a:074e665b09393a8d:4cb87b1a9c78eb5a:1"
time="2021-06-16T17:10:37Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:10:37Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:10:37Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc00037b500 {member1.com}:0xc00037b580 {member2.com}:0xc00037b480]}"
time="2021-06-16T17:10:37Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:10:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:37Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:10:37Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:10:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:10:37Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:10:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:10:37Z" level=info msg="Found 3 tlsconfigs. [0xc0001c1200 0xc0001c1380 0xc0001c1680]"
time="2021-06-16T17:10:37Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:42Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:10:42Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:47Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:10:47Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:10:52Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:10:52Z" level=error msg="None of the tls certificates worked: <nil>"
time="2021-06-16T17:10:52Z" level=info msg="Trying to establish connection using tlsConfig:<nil>"
time="2021-06-16T17:10:57Z" level=error msg="Error occurred while trying to establish connection to: green.nispatil-wcm-cisco.com:443. Error: context deadline exceeded"
time="2021-06-16T17:10:57Z" level=error msg="Failed to dial Network Service Registry at green.nispatil-wcm-cisco.com:443: context deadline exceeded" operation=initRegistryClient span="4cb87b1a9c78eb5a:074e665b09393a8d:4cb87b1a9c78eb5a:1"
2021/06/16 17:10:57 Reporting span 4cb87b1a9c78eb5a:074e665b09393a8d:4cb87b1a9c78eb5a:1
2021/06/16 17:10:57 Reporting span 4cb87b1a9c78eb5a:4cb87b1a9c78eb5a:0000000000000000:1
{"level":"info","ts":1623863457.175364,"caller":"nseinformer/nseInformerController.go:369","msg":"Error processing pod &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}: Connection to Network Registry Server is not available","app":"nse-discovery"}
{"level":"info","ts":1623863457.175464,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863457.1755235,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863457.1755812,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:10:57Z" level=info msg="==--> discovery.FindNetworkService() span:7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
time="2021-06-16T17:10:57Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
time="2021-06-16T17:10:57Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
time="2021-06-16T17:10:57Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:10:57Z" level=info msg="==----> initRegistryClient() span:7116b47e62dd8552:4133860b8d712b2d:7116b47e62dd8552:1"
time="2021-06-16T17:10:57Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:57Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:57Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="7116b47e62dd8552:4133860b8d712b2d:7116b47e62dd8552:1"
time="2021-06-16T17:10:57Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:10:57Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:10:57Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0000740c0 {member1.com}:0xc000074200 {member2.com}:0xc000074040]}"
time="2021-06-16T17:10:57Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:10:57Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:57Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:10:57Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:10:57Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:57Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:10:57Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:10:57Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:10:57Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:10:57Z" level=info msg="Found 3 tlsconfigs. [0xc0004f7800 0xc000001b00 0xc0005a0d80]"
time="2021-06-16T17:10:57Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:02Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:02Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:07Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:07Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:07Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:11:07Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:11:07Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="7116b47e62dd8552:4133860b8d712b2d:7116b47e62dd8552:1"
2021/06/16 17:11:07 Reporting span 7116b47e62dd8552:4133860b8d712b2d:7116b47e62dd8552:1
{"level":"info","ts":1623863467.2188027,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:11:07Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
time="2021-06-16T17:11:07Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
2021/06/16 17:11:07 Reporting span 7116b47e62dd8552:766588340c2a027f:7116b47e62dd8552:1
time="2021-06-16T17:11:07Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1"
2021/06/16 17:11:07 Reporting span 7116b47e62dd8552:7116b47e62dd8552:0000000000000000:1
{"level":"info","ts":1623863467.2233958,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863467.2234323,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863467.2234442,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863467.223472,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:11:07Z" level=info msg="==--> discovery.FindNetworkService() span:6e786a270994636f:6e786a270994636f:0000000000000000:1"
time="2021-06-16T17:11:07Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=6e786a270994636f:6e786a270994636f:0000000000000000:1"
time="2021-06-16T17:11:07Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=6e786a270994636f:6e786a270994636f:0000000000000000:1"
time="2021-06-16T17:11:07Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:11:07Z" level=info msg="==----> initRegistryClient() span:6e786a270994636f:77f270b9f70eb8c4:6e786a270994636f:1"
time="2021-06-16T17:11:07Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:11:17Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:11:17Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="6e786a270994636f:77f270b9f70eb8c4:6e786a270994636f:1"
time="2021-06-16T17:11:17Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:11:17Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:11:17Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000102440 {member1.com}:0xc000102600 {member2.com}:0xc000102340]}"
time="2021-06-16T17:11:17Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:11:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:17Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:11:17Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:11:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:11:17Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:11:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:11:17Z" level=info msg="Found 3 tlsconfigs. [0xc0001c1200 0xc0001c1380 0xc0001c1680]"
time="2021-06-16T17:11:17Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:22Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:22Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:27Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:27Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:32Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:32Z" level=error msg="None of the tls certificates worked: <nil>"
time="2021-06-16T17:11:32Z" level=info msg="Trying to establish connection using tlsConfig:<nil>"
time="2021-06-16T17:11:37Z" level=error msg="Error occurred while trying to establish connection to: green.nispatil-wcm-cisco.com:443. Error: context deadline exceeded"
time="2021-06-16T17:11:37Z" level=error msg="Failed to dial Network Service Registry at green.nispatil-wcm-cisco.com:443: context deadline exceeded" operation=initRegistryClient span="6e786a270994636f:77f270b9f70eb8c4:6e786a270994636f:1"
2021/06/16 17:11:37 Reporting span 6e786a270994636f:77f270b9f70eb8c4:6e786a270994636f:1
2021/06/16 17:11:37 Reporting span 6e786a270994636f:6e786a270994636f:0000000000000000:1
{"level":"info","ts":1623863497.2241945,"caller":"nseinformer/nseInformerController.go:369","msg":"Error processing pod &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}: Connection to Network Registry Server is not available","app":"nse-discovery"}
{"level":"info","ts":1623863497.2242322,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863497.224239,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863497.224249,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:11:37Z" level=info msg="==--> discovery.FindNetworkService() span:75e595473b141095:75e595473b141095:0000000000000000:1"
time="2021-06-16T17:11:37Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=75e595473b141095:75e595473b141095:0000000000000000:1"
time="2021-06-16T17:11:37Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=75e595473b141095:75e595473b141095:0000000000000000:1"
time="2021-06-16T17:11:37Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:11:37Z" level=info msg="==----> initRegistryClient() span:75e595473b141095:67103606017b3a96:75e595473b141095:1"
time="2021-06-16T17:11:37Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:11:37Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:11:37Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="75e595473b141095:67103606017b3a96:75e595473b141095:1"
time="2021-06-16T17:11:37Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:11:37Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:11:37Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b1fc0 {member1.com}:0xc0001b1f40 {member2.com}:0xc0001b1ec0]}"
time="2021-06-16T17:11:37Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:11:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:37Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:11:37Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:11:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:11:37Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:11:37Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:11:37Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:11:37Z" level=info msg="Found 3 tlsconfigs. [0xc000659e00 0xc0004f7800 0xc000001b00]"
time="2021-06-16T17:11:37Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:42Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:42Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:47Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:11:47Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:11:47Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:11:47Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:11:47Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="75e595473b141095:67103606017b3a96:75e595473b141095:1"
2021/06/16 17:11:47 Reporting span 75e595473b141095:67103606017b3a96:75e595473b141095:1
{"level":"info","ts":1623863507.2662146,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:11:47Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=75e595473b141095:75e595473b141095:0000000000000000:1"
time="2021-06-16T17:11:47Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=75e595473b141095:75e595473b141095:0000000000000000:1"
2021/06/16 17:11:47 Reporting span 75e595473b141095:62852dc6b766dd0c:75e595473b141095:1
time="2021-06-16T17:11:47Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=75e595473b141095:75e595473b141095:0000000000000000:1"
2021/06/16 17:11:47 Reporting span 75e595473b141095:75e595473b141095:0000000000000000:1
{"level":"info","ts":1623863507.2718844,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863507.2719672,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863507.2721517,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863507.2724926,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:11:47Z" level=info msg="==--> discovery.FindNetworkService() span:30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
time="2021-06-16T17:11:47Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
time="2021-06-16T17:11:47Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
time="2021-06-16T17:11:47Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:11:47Z" level=info msg="==----> initRegistryClient() span:30483b9e4b5e88be:60468b59ec11e126:30483b9e4b5e88be:1"
time="2021-06-16T17:11:47Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:02Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:02Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="30483b9e4b5e88be:60468b59ec11e126:30483b9e4b5e88be:1"
time="2021-06-16T17:12:02Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:02Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:02Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b09c0 {member1.com}:0xc0001b0a40 {member2.com}:0xc0001b0940]}"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:02Z" level=info msg="Found 3 tlsconfigs. [0xc0003ee000 0xc0003ee480 0xc0003ee600]"
time="2021-06-16T17:12:02Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:02Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:02Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:02Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="30483b9e4b5e88be:60468b59ec11e126:30483b9e4b5e88be:1"
2021/06/16 17:12:02 Reporting span 30483b9e4b5e88be:60468b59ec11e126:30483b9e4b5e88be:1
{"level":"info","ts":1623863522.4282362,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:02Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
time="2021-06-16T17:12:02Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
2021/06/16 17:12:02 Reporting span 30483b9e4b5e88be:6797380ba775c11b:30483b9e4b5e88be:1
time="2021-06-16T17:12:02Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1"
2021/06/16 17:12:02 Reporting span 30483b9e4b5e88be:30483b9e4b5e88be:0000000000000000:1
{"level":"info","ts":1623863522.430398,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863522.4304242,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863522.4304574,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863522.430471,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863522.430482,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863522.430514,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305248,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305332,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305427,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305577,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305675,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305809,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4305902,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863522.430617,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4306283,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4306586,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4306703,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863522.4306812,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863522.43069,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863522.4306982,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863522.4307172,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863522.4307268,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863522.430755,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:12:02Z" level=info msg="==--> discovery.FindNetworkService() span:34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
time="2021-06-16T17:12:02Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
time="2021-06-16T17:12:02Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
time="2021-06-16T17:12:02Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:02Z" level=info msg="==----> initRegistryClient() span:34e1ba9dcc495285:021c92852716e0a2:34e1ba9dcc495285:1"
time="2021-06-16T17:12:02Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:02Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:02Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="34e1ba9dcc495285:021c92852716e0a2:34e1ba9dcc495285:1"
time="2021-06-16T17:12:02Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:02Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:02Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000255a40 {member1.com}:0xc000255ac0 {member2.com}:0xc0002559c0]}"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:02Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:02Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:02Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:02Z" level=info msg="Found 3 tlsconfigs. [0xc0001c1380 0xc0001c1680 0xc0001c1800]"
time="2021-06-16T17:12:02Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:07Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:07Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:12Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:12Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:12Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:12Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:12Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="34e1ba9dcc495285:021c92852716e0a2:34e1ba9dcc495285:1"
2021/06/16 17:12:12 Reporting span 34e1ba9dcc495285:021c92852716e0a2:34e1ba9dcc495285:1
{"level":"info","ts":1623863532.4615738,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:12Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
time="2021-06-16T17:12:12Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
2021/06/16 17:12:12 Reporting span 34e1ba9dcc495285:423aefd2cff71628:34e1ba9dcc495285:1
time="2021-06-16T17:12:12Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1"
2021/06/16 17:12:12 Reporting span 34e1ba9dcc495285:34e1ba9dcc495285:0000000000000000:1
{"level":"info","ts":1623863532.4660149,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863532.4660664,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863532.4660804,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863532.4663913,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:12:12Z" level=info msg="==--> discovery.FindNetworkService() span:7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
time="2021-06-16T17:12:12Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
time="2021-06-16T17:12:12Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
time="2021-06-16T17:12:12Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:12Z" level=info msg="==----> initRegistryClient() span:7de2669ff2cf5882:405cea6fc3c31a67:7de2669ff2cf5882:1"
time="2021-06-16T17:12:12Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:12Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:12Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="7de2669ff2cf5882:405cea6fc3c31a67:7de2669ff2cf5882:1"
time="2021-06-16T17:12:12Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:12Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:12Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0001b0b00 {member1.com}:0xc0001b0b80 {member2.com}:0xc0001b0a80]}"
time="2021-06-16T17:12:12Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:12Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:12Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:12Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:12Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:12Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:12Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:12Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:12Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:12Z" level=info msg="Found 3 tlsconfigs. [0xc00058a180 0xc00058ac00 0xc00058ad80]"
time="2021-06-16T17:12:12Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:12Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:12Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:12Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="7de2669ff2cf5882:405cea6fc3c31a67:7de2669ff2cf5882:1"
2021/06/16 17:12:12 Reporting span 7de2669ff2cf5882:405cea6fc3c31a67:7de2669ff2cf5882:1
{"level":"info","ts":1623863532.5906568,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:12Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
time="2021-06-16T17:12:12Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
2021/06/16 17:12:12 Reporting span 7de2669ff2cf5882:2d6765b05c469aea:7de2669ff2cf5882:1
time="2021-06-16T17:12:12Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1"
2021/06/16 17:12:12 Reporting span 7de2669ff2cf5882:7de2669ff2cf5882:0000000000000000:1
{"level":"info","ts":1623863532.5940661,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863532.594152,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863532.594204,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863532.5942633,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863532.5943158,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944047,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944307,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944417,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944507,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944602,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944824,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5944924,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863532.594501,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863532.59451,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5945356,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5945458,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5945547,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863532.5945816,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863532.5945919,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863532.594621,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863537.1293218,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6bjtj green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6bjtj bc1940f0-d1f7-4201-ab95-951ed8e63d07 2512 1 2021-06-16 17:05:51 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-24scx wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863537.129434,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6bjtj...","app":"nse-discovery"}
{"level":"info","ts":1623863537.129472,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863537.1294663,"caller":"nseinformer/nseInformerController.go:107","msg":"NSE pod: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}} was updated with: &{{ } {green6gqkr green nsm-system /apis/networkservicemesh.io/v1alpha1/namespaces/nsm-system/networkserviceendpoints/green6gqkr ea086f35-cd3b-4708-b648-f753f0dc1442 2516 1 2021-06-16 17:05:52 +0000 UTC <nil> <nil> map[app:vl3-nse-green networkservicename:green nsepod.name:green-kind-3_vl3-nse-green-7555496c4c-5ldtk wcm/nsr.addr:green.nispatil-wcm-cisco.com wcm/nsr.port:443] map[] [] []  []} {green IP kind-3-control-plane} {RUNNING}}","app":"nse-discovery"}
{"level":"info","ts":1623863537.1294892,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:12:17Z" level=info msg="==--> discovery.FindNetworkService() span:5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
time="2021-06-16T17:12:17Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
time="2021-06-16T17:12:17Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
time="2021-06-16T17:12:17Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:17Z" level=info msg="==----> initRegistryClient() span:5a4c83af7d4604e7:3d7d2e158fde3b33:5a4c83af7d4604e7:1"
time="2021-06-16T17:12:17Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:17Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:17Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="5a4c83af7d4604e7:3d7d2e158fde3b33:5a4c83af7d4604e7:1"
time="2021-06-16T17:12:17Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:17Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:17Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000102e40 {member1.com}:0xc000102ec0 {member2.com}:0xc000102cc0]}"
time="2021-06-16T17:12:17Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:17Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:17Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:17Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:17Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:17Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:17Z" level=info msg="Found 3 tlsconfigs. [0xc000202a80 0xc000202d80 0xc000202f00]"
time="2021-06-16T17:12:17Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:22Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:22Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:27Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:27Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:27Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="5a4c83af7d4604e7:3d7d2e158fde3b33:5a4c83af7d4604e7:1"
2021/06/16 17:12:27 Reporting span 5a4c83af7d4604e7:3d7d2e158fde3b33:5a4c83af7d4604e7:1
{"level":"info","ts":1623863547.1628351,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
2021/06/16 17:12:27 Reporting span 5a4c83af7d4604e7:4ea9b9b1610af00d:5a4c83af7d4604e7:1
time="2021-06-16T17:12:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1"
2021/06/16 17:12:27 Reporting span 5a4c83af7d4604e7:5a4c83af7d4604e7:0000000000000000:1
{"level":"info","ts":1623863547.1697073,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863547.1697323,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863547.1697402,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863547.169748,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:12:27Z" level=info msg="==--> discovery.FindNetworkService() span:1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:27Z" level=info msg="==----> initRegistryClient() span:1a2eb3d8612cd435:74e791f33ffe3836:1a2eb3d8612cd435:1"
time="2021-06-16T17:12:27Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:27Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="1a2eb3d8612cd435:74e791f33ffe3836:1a2eb3d8612cd435:1"
time="2021-06-16T17:12:27Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc0000aa480 {member1.com}:0xc0000aa540 {member2.com}:0xc0000aa3c0]}"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:27Z" level=info msg="Found 3 tlsconfigs. [0xc0003ee000 0xc0003ee180 0xc0003ee300]"
time="2021-06-16T17:12:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:27Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:27Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:27Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="1a2eb3d8612cd435:74e791f33ffe3836:1a2eb3d8612cd435:1"
2021/06/16 17:12:27 Reporting span 1a2eb3d8612cd435:74e791f33ffe3836:1a2eb3d8612cd435:1
{"level":"info","ts":1623863547.4467106,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:27Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
2021/06/16 17:12:27 Reporting span 1a2eb3d8612cd435:02c6063ad1bef9d6:1a2eb3d8612cd435:1
time="2021-06-16T17:12:27Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1"
2021/06/16 17:12:27 Reporting span 1a2eb3d8612cd435:1a2eb3d8612cd435:0000000000000000:1
{"level":"info","ts":1623863547.4505515,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863547.4506793,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863547.4506953,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863547.4507046,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863547.4507349,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863547.4508188,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4509287,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4509845,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4510617,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863547.451106,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4511175,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4511268,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4511547,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4511926,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4512258,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4512765,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863547.451308,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863547.4513192,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863547.4513288,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863547.4513366,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863547.4513521,"caller":"nseinformer/nseInformerController.go:156","msg":"Processing NSE named green6gqkr...","app":"nse-discovery"}
{"level":"info","ts":1623863547.4513817,"caller":"nseinformer/nseInformerController.go:163","msg":"Found service name: green","app":"nse-discovery"}
{"level":"info","ts":1623863547.451416,"caller":"nseinformer/nseInformerController.go:178","msg":"Getting endpoints from the local NSR","app":"nse-discovery"}
time="2021-06-16T17:12:27Z" level=info msg="==--> discovery.FindNetworkService() span:09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg=">><<-- nsrURL=\"wcm-proxy-nsmgr.nsm-system:5005\" span=09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
time="2021-06-16T17:12:27Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:27Z" level=info msg="==----> initRegistryClient() span:09e532ce5fda58d1:04f3c77373c98bed:09e532ce5fda58d1:1"
time="2021-06-16T17:12:27Z" level=info msg="Waiting for liveness probe: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:27Z" level=info msg="Liveness probe was successful: tcp:wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:27Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="09e532ce5fda58d1:04f3c77373c98bed:09e532ce5fda58d1:1"
time="2021-06-16T17:12:27Z" level=info msg="Trying to establish connection to target: wcm-proxy-nsmgr.nsm-system:5005"
time="2021-06-16T17:12:27Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:27Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000074000 {member1.com}:0xc0000abf80 {member2.com}:0xc0000abf00]}"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:27Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:27Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:27Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:27Z" level=info msg="Found 3 tlsconfigs. [0xc0003ef980 0xc0003efb00 0xc0003efc80]"
time="2021-06-16T17:12:27Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:32Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:32Z" level=info msg="trying to connect to target using tls: 1 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:37Z" level=warning msg="Tls didnt match server tls Error: context deadline exceeded"
time="2021-06-16T17:12:37Z" level=info msg="trying to connect to target using tls: 2 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:37Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:37Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:37Z" level=info msg="Successfully connected to wcm-proxy-nsmgr.nsm-system:5005" operation=initRegistryClient span="09e532ce5fda58d1:04f3c77373c98bed:09e532ce5fda58d1:1"
2021/06/16 17:12:37 Reporting span 09e532ce5fda58d1:04f3c77373c98bed:09e532ce5fda58d1:1
{"level":"info","ts":1623863557.484488,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:37Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
time="2021-06-16T17:12:37Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
2021/06/16 17:12:37 Reporting span 09e532ce5fda58d1:4b3d471a8a9b3a90:09e532ce5fda58d1:1
time="2021-06-16T17:12:37Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1"
2021/06/16 17:12:37 Reporting span 09e532ce5fda58d1:09e532ce5fda58d1:0000000000000000:1
{"level":"info","ts":1623863557.490922,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863557.4911563,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863557.4912813,"caller":"nseinformer/nseInformerController.go:186","msg":"Retrieved 2 endpoints from the local NSR","app":"nse-discovery"}
{"level":"info","ts":1623863557.491317,"caller":"nseinformer/nseInformerController.go:189","msg":"Getting endpoints from the global NSR at: green.nispatil-wcm-cisco.com:443","app":"nse-discovery"}
time="2021-06-16T17:12:37Z" level=info msg="==--> discovery.FindNetworkService() span:5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
time="2021-06-16T17:12:37Z" level=info msg=">><<-- request={\"network_service_name\":\"green\"} span=5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
time="2021-06-16T17:12:37Z" level=info msg=">><<-- nsrURL=\"green.nispatil-wcm-cisco.com:443\" span=5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
time="2021-06-16T17:12:37Z" level=info msg="Requesting NetworkServiceDiscoveryClient..."
time="2021-06-16T17:12:37Z" level=info msg="==----> initRegistryClient() span:5b0b904259e2a6e2:28438a330e4230c7:5b0b904259e2a6e2:1"
time="2021-06-16T17:12:37Z" level=info msg="Waiting for liveness probe: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:47Z" level=info msg="Liveness probe was successful: tcp:green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:47Z" level=info msg="Registry port now available, attempting to connect..." operation=initRegistryClient span="5b0b904259e2a6e2:28438a330e4230c7:5b0b904259e2a6e2:1"
time="2021-06-16T17:12:47Z" level=info msg="Trying to establish connection to target: green.nispatil-wcm-cisco.com:443"
time="2021-06-16T17:12:47Z" level=info msg="Connecting to the workload api at:unix:///run/spire/sockets/agent.sock"
time="2021-06-16T17:12:47Z" level=info msg="Successfully retrieve bundles:&{{{0 0} 0 0 0 0} map[{central.com}:0xc000074c00 {member1.com}:0xc000074940 {member2.com}:0xc0000748c0]}"
time="2021-06-16T17:12:47Z" level=info msg="defaultTrustDomain:central.com"
time="2021-06-16T17:12:47Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:47Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-06-16T17:12:47Z" level=info msg="defaultTrustDomain:member1.com"
time="2021-06-16T17:12:47Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:47Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-06-16T17:12:47Z" level=info msg="defaultTrustDomain:member2.com"
time="2021-06-16T17:12:47Z" level=info msg="AUTHORIZING ALL CLIENTS"
time="2021-06-16T17:12:47Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-06-16T17:12:47Z" level=info msg="Found 3 tlsconfigs. [0xc0003ee180 0xc0003ee300 0xc0003ee480]"
time="2021-06-16T17:12:47Z" level=info msg="trying to connect to target using tls: 0 &{Rand:<nil> Time:<nil> Certificates:[] NameToCertificate:map[] GetCertificate:<nil> GetClientCertificate:0xca3d80 GetConfigForClient:<nil> VerifyPeerCertificate:0xca3e00 VerifyConnection:<nil> RootCAs:<nil> NextProtos:[] ServerName: ClientAuth:NoClientCert ClientCAs:<nil> InsecureSkipVerify:true CipherSuites:[] PreferServerCipherSuites:false SessionTicketsDisabled:false SessionTicketKey:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] ClientSessionCache:<nil> MinVersion:0 MaxVersion:0 CurvePreferences:[] DynamicRecordSizingDisabled:false Renegotiation:0 KeyLogWriter:<nil> mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} sessionTicketKeys:[] autoSessionTicketKeys:[]}"
time="2021-06-16T17:12:47Z" level=info msg="Found the right tls certificate:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:47Z" level=info msg="Trying to establish connection using tlsConfig:&{<nil> <nil> [] map[] <nil> 0xca3d80 <nil> 0xca3e00 <nil> <nil> []  NoClientCert <nil> true [] false false [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] <nil> 0 0 [] false 0 <nil> {{0 0} 0 0 0 0} [] []}"
time="2021-06-16T17:12:54Z" level=info msg="Successfully connected to green.nispatil-wcm-cisco.com:443" operation=initRegistryClient span="5b0b904259e2a6e2:28438a330e4230c7:5b0b904259e2a6e2:1"
2021/06/16 17:12:54 Reporting span 5b0b904259e2a6e2:28438a330e4230c7:5b0b904259e2a6e2:1
{"level":"info","ts":1623863574.273535,"caller":"nseinformer/nseInformerController.go:408","msg":"Discover NSEs from NSR: network_service_name:\"green\" ","app":"nse-discovery"}
time="2021-06-16T17:12:54Z" level=info msg=">><<---- /registry.NetworkServiceDiscovery/FindNetworkService()=\"\" span=5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
time="2021-06-16T17:12:54Z" level=info msg=">><<---- request={\"network_service_name\":\"green\"} span=5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
2021/06/16 17:12:54 Reporting span 5b0b904259e2a6e2:00e1ba7ad0c13c10:5b0b904259e2a6e2:1
time="2021-06-16T17:12:54Z" level=info msg=">><<---- response={\"payload\":\"IP\",\"network_service\":{\"name\":\"green\",\"payload\":\"IP\"},\"network_service_managers\":{\"kind-2-control-plane\":{\"name\":\"kind-2-control-plane\",\"url\":\"172.17.0.3:5001\",\"expiration_time\":{\"seconds\":1623866690},\"state\":\"RUNNING\"},\"kind-3-control-plane\":{\"name\":\"kind-3-control-plane\",\"url\":\"172.17.0.4:5001\",\"expiration_time\":{\"seconds\":1623866761},\"state\":\"RUNNING\"}},\"network_service_endpoints\":[{\"name\":\"greenbtshl\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-6tfnk\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"greenn5mqx\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-2-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-2_vl3-nse-green-76bc7f4b96-8hv98\",\"wcm/cluster\":\"member1\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6bjtj\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-24scx\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"},{\"name\":\"green6gqkr\",\"payload\":\"IP\",\"network_service_name\":\"green\",\"network_service_manager_name\":\"kind-3-control-plane\",\"labels\":{\"app\":\"vl3-nse-green\",\"networkservicename\":\"green\",\"nsepod.name\":\"green-kind-3_vl3-nse-green-7555496c4c-5ldtk\",\"wcm/cluster\":\"member2\",\"wcm/nsr.addr\":\"green.nispatil-wcm-cisco.com\",\"wcm/nsr.port\":\"443\"},\"state\":\"RUNNING\"}]} span=5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1"
2021/06/16 17:12:54 Reporting span 5b0b904259e2a6e2:5b0b904259e2a6e2:0000000000000000:1
{"level":"info","ts":1623863574.2760549,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenbtshl","app":"nse-discovery"}
{"level":"info","ts":1623863574.2760847,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name greenn5mqx","app":"nse-discovery"}
{"level":"info","ts":1623863574.276093,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6bjtj","app":"nse-discovery"}
{"level":"info","ts":1623863574.2761004,"caller":"nseinformer/nseInformerController.go:316","msg":"found NSE with name green6gqkr","app":"nse-discovery"}
{"level":"info","ts":1623863574.2761333,"caller":"nseinformer/nseInformerController.go:198","msg":"Retrieved 4 endpoints from the global NSR","app":"nse-discovery"}
{"level":"info","ts":1623863574.276149,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2761579,"caller":"nseinformer/nseInformerController.go:331","msg":"NSE diff:  For cluster member2, skipping endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2761667,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863574.276176,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762072,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863574.276219,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863574.276228,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762368,"caller":"nseinformer/nseInformerController.go:328","msg":"NSE diff: For cluster member2, adding endpoint 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762463,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenbtshl'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762575,"caller":"nseinformer/nseInformerController.go:344","msg":"NSE diff:  For cluster member2, skip comparing endpoint 'greenn5mqx'","app":"nse-discovery"}
{"level":"info","ts":1623863574.276267,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6bjtj'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762754,"caller":"nseinformer/nseInformerController.go:341","msg":"NSE diff: For cluster member2, endpoint match 'green6gqkr'","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762845,"caller":"nseinformer/nseInformerController.go:203","msg":"Global NSE diff result: 0 new NSEs to add, 0 NSEs to delete","app":"nse-discovery"}
{"level":"info","ts":1623863574.2762926,"caller":"nseinformer/nseInformerController.go:240","msg":"No endpoints to register to Global registry.","app":"nse-discovery"}
{"level":"info","ts":1623863574.2763011,"caller":"nseinformer/nseInformerController.go:266","msg":"No endpoints to remove from Global registry.","app":"nse-discovery"}
==== END logs for container wcm-nse-discovery of pod wcm-system/wcm-nse-discovery-5f68d85698-8shgw ====
