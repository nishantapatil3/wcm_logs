{"level":"info","ts":1632438464.465466,"caller":"cmd/main.go:45","msg":"Starting application APP-DNS-Publisher...","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655118,"caller":"utils/nsrenv.go:29","msg":"All env variables:","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655275,"caller":"utils/nsrenv.go:31","msg":"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655373,"caller":"utils/nsrenv.go:31","msg":"HOSTNAME=example-app-dns-publisher-7fcddd4689-zfm8k","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655468,"caller":"utils/nsrenv.go:31","msg":"POD_UID=40d75133-d3f0-4185-9286-384359ff8812","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655557,"caller":"utils/nsrenv.go:31","msg":"INSECURE=false","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655592,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_SERVICE_PORT_GRPC_NSR=31505","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465569,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_PORT_50071_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655817,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_HOST=10.108.33.188","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655857,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50061_TCP=tcp://10.99.42.140:50061","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4655957,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_ADDR=10.104.87.72","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656053,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50061_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656196,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50051_TCP=tcp://10.99.42.140:50051","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656236,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656274,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_SERVICE_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465639,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP=tcp://10.108.33.188:2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656432,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_PORT=tcp://10.101.160.233:31505","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656472,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_PORT_31505_TCP=tcp://10.101.160.233:31505","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465651,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_SERVICE_PORT_GRPC_REGISTRY=50061","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656549,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_2112_TCP_ADDR=10.99.42.140","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656665,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT=443","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.46567,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_SERVICE_PORT_INFO_HTTP=50071","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656737,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656844,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_PORT=tcp://10.101.19.159:50071","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465694,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_HOST=10.96.0.1","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4656978,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT=tcp://10.108.33.188:2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4657018,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_PORT=443","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4657128,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465717,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_PORT_31505_TCP_ADDR=10.101.160.233","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4657311,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_SERVICE_PORT=50071","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4657354,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT=tcp://10.99.42.140:50061","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4657393,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50051_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465826,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_SERVICE_PORT_HTTPS=443","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658308,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658349,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658387,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_CLIENT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658425,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_PORT_31505_TCP_PORT=31505","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465846,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_PROTO=udp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658499,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP_PORT=53","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658535,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50051_TCP_ADDR=10.99.42.140","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658573,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT=tcp://10.96.0.1:443","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658608,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP_ADDR=10.108.22.41","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658647,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_PORT_50071_TCP_ADDR=10.101.19.159","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658685,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_SERVICE_HOST=10.99.42.140","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658723,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_2112_TCP=tcp://10.99.42.140:2112","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658763,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_2112_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.46588,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_PORT_2379_TCP=tcp://10.108.22.41:2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658842,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_ADDR=10.108.33.188","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4658883,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_2112_TCP_PORT=2112","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659007,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_PORT_31505_TCP_PROTO=tcp","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659047,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_PORT_50071_TCP_PORT=50071","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659085,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_SERVICE_HOST=10.104.87.72","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659123,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_SERVICE_PORT_GRPC_ALLOCATOR=50051","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659162,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50061_TCP_PORT=50061","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659197,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_SERVICE_PORT=31505","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465923,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT=udp://10.104.87.72:53","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659266,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659305,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_PORT_2379_TCP_PORT=2379","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659343,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_PORT_50071_TCP=tcp://10.101.19.159:50071","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465938,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_SERVICE_PORT=53","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465942,"caller":"utils/nsrenv.go:31","msg":"MY_COREDNS_COREDNS_PORT_53_UDP=udp://10.104.87.72:53","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465946,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_SERVICE_PORT=50061","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659495,"caller":"utils/nsrenv.go:31","msg":"KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465953,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_SERVICE_HOST=10.101.160.233","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659567,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_SERVICE_PORT_MONITORING=2112","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659603,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50061_TCP_ADDR=10.99.42.140","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659638,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_WCMD_PORT_50051_TCP_PORT=50051","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659674,"caller":"utils/nsrenv.go:31","msg":"WCM_ETCD_CLUSTER_CLIENT_SERVICE_SERVICE_HOST=10.108.22.41","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.4659772,"caller":"utils/nsrenv.go:31","msg":"EXAMPLE_CD_INFO_SERVICE_HOST=10.101.19.159","app":"app-dns-publisher"}
{"level":"info","ts":1632438464.465981,"caller":"utils/nsrenv.go:31","msg":"HOME=/root","app":"app-dns-publisher"}
W0923 23:07:44.465996       1 client_config.go:543] Neither --kubeconfig nor --master was specified.  Using the inClusterConfig.  This might not work.
{"level":"info","ts":1632438464.4663222,"caller":"controller/controller.go:142","msg":"Waiting for connection to be ready. Connecting to example-wcmd:50051","app":"app-dns-publisher"}
time="2021-09-23T23:07:44Z" level=info msg="Establish connection with the spire provider at address:unix:///run/spire/sockets/agent.sock"
time="2021-09-23T23:07:45Z" level=info msg="Issued identity:spiffe://central.com/example-app-dns-publisher"
time="2021-09-23T23:07:45Z" level=info msg="Fetch tlsConfig for Trust Domain: central.com"
time="2021-09-23T23:07:45Z" level=info msg="Fetch tlsConfig for Trust Domain: member1.com"
time="2021-09-23T23:07:45Z" level=info msg="Fetch tlsConfig for Trust Domain: member2.com"
time="2021-09-23T23:07:45Z" level=info msg="Retrived 3 tlsconfigs"
time="2021-09-23T23:07:50Z" level=error msg="Failed to get the right certificate for target: example-wcmd:50051"
time="2021-09-23T23:07:50Z" level=error msg="tls config is nil for target: example-wcmd:50051"
{"level":"error","ts":1632438470.533443,"caller":"controller/controller.go:145","msg":"unable to connect to server: tls config is nil for target: example-wcmd:50051","app":"app-dns-publisher","stacktrace":"cisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewClient\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/pkg/controller/controller.go:145\ncisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewController\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/pkg/controller/controller.go:98\nmain.glob..func1\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:51\ngithub.com/spf13/cobra.(*Command).execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:203"}
{"level":"error","ts":1632438470.5336218,"caller":"controller/controller.go:100","msg":"error creating new service registry client, err tls config is nil for target: example-wcmd:50051","app":"app-dns-publisher","stacktrace":"cisco-app-networking.github.io/wcm-common/app-dns-publisher/pkg/controller.NewController\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/pkg/controller/controller.go:100\nmain.glob..func1\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:51\ngithub.com/spf13/cobra.(*Command).execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:203"}
{"level":"error","ts":1632438470.5337265,"caller":"cmd/main.go:54","msg":"could not create watcher, err:%!(EXTRA *errors.errorString=tls config is nil for target: example-wcmd:50051)","app":"app-dns-publisher","stacktrace":"main.glob..func1\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:54\ngithub.com/spf13/cobra.(*Command).execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:852\ngithub.com/spf13/cobra.(*Command).ExecuteC\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:960\ngithub.com/spf13/cobra.(*Command).Execute\n\t/home/ubuntu/go/pkg/mod/github.com/spf13/cobra@v1.1.3/command.go:897\nmain.main\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:88\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:203"}
Error: tls config is nil for target: example-wcmd:50051
{"level":"error","ts":1632438470.5338304,"caller":"cmd/main.go:89","msg":"tls config is nil for target: example-wcmd:50051","app":"app-dns-publisher","stacktrace":"main.main\n\t/mnt/workspace/app-networking_wcm-common_master/app-dns-publisher/cmd/main.go:89\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:203"}
